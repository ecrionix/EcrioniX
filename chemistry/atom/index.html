<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6672302762343789"
     crossorigin="anonymous"></script>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZS8C1FLY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XXZS8C1FLY');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build an Atom - EcrioniX Labs</title>
    <!-- FIXME: Google AdSense Script Placeholder -->
    <!-- Paste your AdSense script code here -->
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #020617; color: #f8fafc; overflow: hidden; }
        .brand-font { font-family: 'Orbitron', sans-serif; }
        
        /* Watermark */
        .watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-30deg);
            font-size: 8rem;
            font-weight: 900;
            color: rgba(45, 212, 191, 0.03);
            pointer-events: none;
            user-select: none;
            white-space: nowrap;
            z-index: 0;
        }

        /* Atom Canvas */
        #atom-canvas {
            background: radial-gradient(circle at center, #1e293b 0%, #0f172a 70%);
            border-radius: 50%;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.5);
        }

        /* Particles */
        .particle {
            width: 30px; height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            color: white;
            box-shadow: inset -2px -2px 6px rgba(0,0,0,0.3), 2px 2px 5px rgba(0,0,0,0.3);
            cursor: grab;
            position: absolute;
            user-select: none;
            z-index: 50;
            /* Ensure particle itself faces front or looks spherical */
            background-size: 200% 200%;
        }
        .particle:active { cursor: grabbing; transform: scale(1.1); }
        
        /* Gradients adjusted for pseudo-3D lighting */
        .proton { background: radial-gradient(circle at 35% 35%, #ef4444 0%, #991b1b 80%); border: 1px solid #f87171; }
        .neutron { background: radial-gradient(circle at 35% 35%, #94a3b8 0%, #475569 80%); border: 1px solid #cbd5e1; }
        .electron { background: radial-gradient(circle at 35% 35%, #3b82f6 0%, #1e3a8a 80%); border: 1px solid #60a5fa; width: 20px; height: 20px; font-size: 10px; }

        /* Orbital Animations */
        @keyframes orbit-spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .orbit-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; /* Let clicks pass through container */
            animation: orbit-spin linear infinite;
        }
        
        /* Ensure electrons inside rotating layers are clickable */
        .orbit-layer .particle { pointer-events: auto; transform-origin: center center; }

        #orbit-k { animation-duration: 4s; }
        #orbit-l { animation-duration: 8s; animation-direction: reverse; }
        #orbit-m { animation-duration: 16s; }

        /* Buckets */
        .bucket {
            background: rgba(30, 41, 59, 0.5);
            border: 2px dashed #475569;
            border-radius: 12px;
            padding: 10px;
            min-height: 80px;
            display: flex;
            flex-wrap: wrap;
            align-content: flex-start;
            gap: 5px;
            position: relative;
        }
        .bucket-label {
            position: absolute;
            bottom: -20px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 12px;
            color: #94a3b8;
            font-weight: bold;
        }

        /* Nucleus 3D Style */
        #nucleus-container {
            perspective: 800px;
            width: 200px; height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #nucleus {
            position: relative;
            width: 0; height: 0;
            transform-style: preserve-3d;
            /* Animation handled in JS for sorting */
        }
        .nucleon {
            position: absolute;
            top: 0; left: 0;
            margin: -15px 0 0 -15px; /* Center the particle (30px width / 2) */
            backface-visibility: visible; /* Spheres are visible from back */
        }

    </style>
</head>
<body class="relative h-screen flex flex-col">

    <div class="watermark">EcrioniX</div>

    <!-- Header -->
    <nav class="sticky top-0 z-50 border-b border-slate-800 bg-slate-950/80 backdrop-blur-md px-6 py-3 flex justify-between items-center">
        <div class="flex items-center">
            <span class="brand-font text-2xl font-bold text-white tracking-wider">Ecrioni<span class="text-teal-500">X</span></span>
            <span class="ml-4 px-2 py-1 bg-teal-500/10 text-teal-400 text-xs rounded border border-teal-500/20">ATOM BUILDER</span>
        </div>
        <a href="../index.html" class="text-sm text-slate-400 hover:text-white transition flex items-center">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
            Back to Chemistry
        </a>
    </nav>

    <!-- Main Workspace -->
    <div class="flex-grow flex relative overflow-hidden">
        
        <!-- Left: Controls & Buckets -->
        <div class="w-80 bg-slate-900 border-r border-slate-800 p-6 z-10 flex flex-col gap-8 shadow-xl">
            
            <div class="text-center mb-2">
                <h2 class="text-xl font-bold text-white brand-font">Particle Source</h2>
                <p class="text-xs text-slate-500">Click particles to add</p>
            </div>

            <!-- Proton Bucket -->
            <div class="relative group">
                <div class="bucket" id="bucket-p">
                    <!-- Javascript will fill this with draggable clones -->
                </div>
                <div class="bucket-label text-red-400">Protons (+1)</div>
                <div class="absolute top-2 right-2 text-xs font-mono text-slate-500" id="count-p">0</div>
            </div>

            <!-- Neutron Bucket -->
            <div class="relative group">
                <div class="bucket" id="bucket-n"></div>
                <div class="bucket-label text-slate-400">Neutrons (0)</div>
                <div class="absolute top-2 right-2 text-xs font-mono text-slate-500" id="count-n">0</div>
            </div>

            <!-- Electron Bucket -->
            <div class="relative group">
                <div class="bucket" id="bucket-e"></div>
                <div class="bucket-label text-blue-400">Electrons (-1)</div>
                <div class="absolute top-2 right-2 text-xs font-mono text-slate-500" id="count-e">0</div>
            </div>

            <button onclick="resetAtom()" class="mt-auto w-full bg-slate-800 hover:bg-slate-700 text-white py-3 rounded-lg font-bold transition border border-slate-700 hover:border-red-500/50">
                Reset Atom
            </button>
        </div>

        <!-- Center: Visualization -->
        <div class="flex-grow relative bg-slate-950 flex items-center justify-center" id="drop-zone">
            
            <!-- Atom Model (SVG/Canvas Layer) -->
            <div id="atom-container" class="relative w-[600px] h-[600px]">
                <!-- Orbital Shells (SVG) -->
                <svg width="100%" height="100%" viewBox="0 0 600 600" class="absolute inset-0 pointer-events-none">
                    <!-- Shell 3 (M) -->
                    <circle cx="300" cy="300" r="250" fill="none" stroke="#334155" stroke-width="1" stroke-dasharray="5,5" />
                    <!-- Shell 2 (L) -->
                    <circle cx="300" cy="300" r="180" fill="none" stroke="#334155" stroke-width="1" stroke-dasharray="5,5" />
                    <!-- Shell 1 (K) -->
                    <circle cx="300" cy="300" r="100" fill="none" stroke="#334155" stroke-width="1" stroke-dasharray="5,5" />
                    
                    <!-- Nucleus Zone Highlight -->
                    <circle cx="300" cy="300" r="40" fill="rgba(255,255,255,0.02)" stroke="none" />
                </svg>

                <!-- Nucleus Container (Particles go here) -->
                <div id="nucleus-container" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20">
                    <div id="nucleus">
                        <!-- Protons/Neutrons placed here in 3D -->
                    </div>
                </div>

                <!-- Electron Orbits (Electrons go here) -->
                <div id="orbit-m" class="orbit-layer"></div>
                <div id="orbit-l" class="orbit-layer"></div>
                <div id="orbit-k" class="orbit-layer"></div>
            </div>

            <!-- Dynamic Info Panels (Floating) -->
            <div class="absolute top-6 right-6 flex flex-col gap-4 w-64">
                
                <!-- Element Card -->
                <div class="glass-panel bg-slate-800/90 backdrop-blur border border-teal-500/30 p-4 rounded-xl shadow-2xl">
                    <div class="flex justify-between items-start">
                        <div>
                            <div class="text-4xl font-bold text-white brand-font" id="symbol">H</div>
                            <div class="text-sm text-teal-400 font-bold" id="element-name">Hydrogen</div>
                        </div>
                        <div class="text-right">
                            <div class="text-xs text-slate-400">Mass Number</div>
                            <div class="text-xl font-mono text-white" id="mass-num">1</div>
                        </div>
                    </div>
                    <div class="mt-2 pt-2 border-t border-slate-700 flex justify-between text-xs">
                        <span class="text-slate-400">Atomic #: <span id="atomic-num" class="text-white">1</span></span>
                        <span class="text-slate-400">Charge: <span id="net-charge" class="text-white">0</span></span>
                    </div>
                </div>

                <!-- Stability Indicator -->
                <div class="glass-panel bg-slate-900/80 border border-slate-700 p-3 rounded-lg flex items-center justify-between">
                    <span class="text-xs font-bold text-slate-300">NUCLEUS STATUS</span>
                    <span id="stability-tag" class="px-2 py-1 rounded text-xs font-bold bg-green-500/20 text-green-400 border border-green-500/50">STABLE</span>
                </div>

                <!-- Ion Indicator -->
                <div class="glass-panel bg-slate-900/80 border border-slate-700 p-3 rounded-lg flex items-center justify-between">
                    <span class="text-xs font-bold text-slate-300">ION STATUS</span>
                    <span id="ion-tag" class="px-2 py-1 rounded text-xs font-bold bg-slate-700 text-slate-300">NEUTRAL ATOM</span>
                </div>

            </div>

        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-slate-950 border-t border-slate-800 py-3 text-center z-50">
        <p class="text-slate-600 text-xs">
            &copy; 2026 EcrioniX Labs. Owned by <span class="text-teal-400">Elangovan</span>.
        </p>
    </footer>

    <!-- Scripts -->
    <script>
        // --- Data ---
        const elements = [
            { name: "Vacuum", sym: "?", stable: [] }, // 0
            { name: "Hydrogen", sym: "H", stable: [1, 2] },
            { name: "Helium", sym: "He", stable: [3, 4] },
            { name: "Lithium", sym: "Li", stable: [6, 7] },
            { name: "Beryllium", sym: "Be", stable: [9] },
            { name: "Boron", sym: "B", stable: [10, 11] },
            { name: "Carbon", sym: "C", stable: [12, 13] },
            { name: "Nitrogen", sym: "N", stable: [14, 15] },
            { name: "Oxygen", sym: "O", stable: [16, 17, 18] },
            { name: "Fluorine", sym: "F", stable: [19] },
            { name: "Neon", sym: "Ne", stable: [20, 21, 22] }
        ];

        let pCount = 1;
        let nCount = 0;
        let eCount = 1;
        
        let rotationY = 0;
        let rotationX = 15; // Initial tilt
        let particles3D = []; // Store current nucleus particles with 3D coords

        // --- Init ---
        const bucketP = document.getElementById('bucket-p');
        const bucketN = document.getElementById('bucket-n');
        const bucketE = document.getElementById('bucket-e');
        const nucleus = document.getElementById('nucleus');
        
        // Fill source buckets (Visual only, Logic handles counts)
        function fillBuckets() {
            bucketP.innerHTML = `<div class="particle proton cursor-pointer" onclick="addParticle('p')">p+</div>`.repeat(5);
            bucketN.innerHTML = `<div class="particle neutron cursor-pointer" onclick="addParticle('n')">n0</div>`.repeat(5);
            bucketE.innerHTML = `<div class="particle electron cursor-pointer" onclick="addParticle('e')">e-</div>`.repeat(5);
        }

        function addParticle(type) {
            if (type === 'p') {
                if (pCount < 10) pCount++;
            } else if (type === 'n') {
                if (nCount < 12) nCount++;
            } else if (type === 'e') {
                if (eCount < 10) eCount++;
            }
            updateAtom();
        }

        function removeParticle(type) {
            if (type === 'p' && pCount > 0) pCount--;
            if (type === 'n' && nCount > 0) nCount--;
            if (type === 'e' && eCount > 0) eCount--;
            updateAtom();
        }

        function resetAtom() {
            pCount = 1; nCount = 0; eCount = 1;
            updateAtom();
        }

        // --- Render Logic ---
        function updateAtom() {
            // 1. Rebuild Nucleus Particles Array
            particles3D = [];
            for(let i=0; i<pCount; i++) particles3D.push({type: 'p', id: i});
            for(let i=0; i<nCount; i++) particles3D.push({type: 'n', id: i});

            // Shuffle for random distribution
            for (let i = particles3D.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [particles3D[i], particles3D[j]] = [particles3D[j], particles3D[i]];
            }

            // Distribute points on sphere (Fibonacci Sphere)
            const phi = Math.PI * (3 - Math.sqrt(5)); // golden angle
            const n = particles3D.length;
            
            // Adjust radius based on count to keep them packed but visible
            const radius = Math.max(15, Math.cbrt(n) * 14); 

            particles3D.forEach((p, i) => {
                const y = 1 - (i / (n - 1 + 1e-9)) * 2; 
                const radiusAtY = Math.sqrt(1 - y * y);
                const theta = phi * i;

                // Base coordinates on the sphere surface
                p.x = Math.cos(theta) * radiusAtY * radius;
                p.y = y * radius;
                p.z = Math.sin(theta) * radiusAtY * radius;
            });

            // Clear DOM
            nucleus.innerHTML = '';
            
            // Create DOM elements
            particles3D.forEach(p => {
                const el = document.createElement('div');
                el.className = `particle nucleon cursor-pointer hover:scale-90 ${p.type === 'p' ? 'proton' : 'neutron'}`;
                el.innerText = p.type === 'p' ? '+' : '0';
                el.onclick = () => removeParticle(p.type);
                // We don't set transform here, we set it in loop to handle rotation
                p.element = el;
                nucleus.appendChild(el);
            });


            // 2. Update Electrons (Shells)
            const shellK = Math.min(eCount, 2);
            const shellL = Math.min(Math.max(eCount - 2, 0), 8);
            const shellM = Math.max(eCount - 10, 0);

            renderOrbit('orbit-k', shellK, 100);
            renderOrbit('orbit-l', shellL, 180);
            renderOrbit('orbit-m', shellM, 250);

            // 3. Update Stats
            document.getElementById('count-p').innerText = pCount;
            document.getElementById('count-n').innerText = nCount;
            document.getElementById('count-e').innerText = eCount;

            const elData = elements[pCount] || { name: "Unknown", sym: "?", stable: [] };
            
            document.getElementById('symbol').innerText = elData.sym;
            document.getElementById('element-name').innerText = elData.name;
            document.getElementById('atomic-num').innerText = pCount;
            
            const mass = pCount + nCount;
            document.getElementById('mass-num').innerText = mass;

            // Stability Check
            const isStable = elData.stable.includes(mass);
            const stabTag = document.getElementById('stability-tag');
            if (pCount === 0) {
                stabTag.innerText = "--"; stabTag.className = "px-2 py-1 rounded text-xs font-bold bg-slate-800 text-slate-500";
            } else if (isStable) {
                stabTag.innerText = "STABLE";
                stabTag.className = "px-2 py-1 rounded text-xs font-bold bg-green-500/20 text-green-400 border border-green-500/50";
            } else {
                stabTag.innerText = "UNSTABLE";
                stabTag.className = "px-2 py-1 rounded text-xs font-bold bg-red-500/20 text-red-400 border border-red-500/50 animate-pulse";
            }

            // Charge Check
            const charge = pCount - eCount;
            const chargeText = charge > 0 ? `+${charge}` : charge;
            document.getElementById('net-charge').innerText = chargeText;
            
            const ionTag = document.getElementById('ion-tag');
            if (charge === 0) {
                ionTag.innerText = "NEUTRAL ATOM";
                ionTag.className = "px-2 py-1 rounded text-xs font-bold bg-slate-700 text-slate-300";
            } else {
                ionTag.innerText = charge > 0 ? "POSITIVE ION (CATION)" : "NEGATIVE ION (ANION)";
                ionTag.className = "px-2 py-1 rounded text-xs font-bold bg-purple-500/20 text-purple-400 border border-purple-500/50";
            }
        }

        function renderOrbit(id, count, radius) {
            const layer = document.getElementById(id);
            layer.innerHTML = ''; 

            for(let i=0; i<count; i++) {
                const angle = (i / count) * 2 * Math.PI;
                const x = 300 + Math.cos(angle) * radius - 10;
                const y = 300 + Math.sin(angle) * radius - 10;
                
                const el = document.createElement('div');
                el.className = `particle electron cursor-pointer hover:scale-125`;
                el.style.left = `${x}px`;
                el.style.top = `${y}px`;
                el.innerText = '-';
                el.onmousedown = (e) => {
                    e.stopPropagation();
                    removeParticle('e');
                };
                layer.appendChild(el);
            }
        }

        // --- 3D Rotation Loop ---
        function animateNucleus() {
            rotationY += 0.5; // Speed of rotation
            
            // Convert degrees to radians
            const radY = rotationY * Math.PI / 180;
            const radX = 15 * Math.PI / 180; // Fixed tilt for better 3D view

            // Update each particle's 3D position based on rotation
            particles3D.forEach(p => {
                // Apply Rotation Matrix: Rotate Y then Rotate X
                // 1. Rotate around Y axis
                let x1 = p.x * Math.cos(radY) - p.z * Math.sin(radY);
                let z1 = p.x * Math.sin(radY) + p.z * Math.cos(radY);
                let y1 = p.y;

                // 2. Rotate around X axis (Tilt)
                let y2 = y1 * Math.cos(radX) - z1 * Math.sin(radX);
                let z2 = y1 * Math.sin(radX) + z1 * Math.cos(radX);
                let x2 = x1;

                // Apply transforms
                p.element.style.transform = `translate3d(${x2}px, ${y2}px, ${z2}px)`;
                
                // Update Z-Index for occlusion (higher z = closer to viewer)
                p.element.style.zIndex = Math.floor(z2 + 200); 
                
                // Optional: Scale slightly for perspective depth
                // const scale = 1 + (z2 / 500); 
                // p.element.style.transform += ` scale(${scale})`;
            });

            requestAnimationFrame(animateNucleus);
        }

        // Init
        fillBuckets();
        updateAtom();
        animateNucleus();

    </script>
</body>
</html>
