<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZS8C1FLY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XXZS8C1FLY');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gate Level Netlist - EcrioniX Labs</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Orbitron:wght@500;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <!-- MathJax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #020617; color: #f8fafc; overflow: hidden; }
        .tech-font { font-family: 'Orbitron', sans-serif; }
        .mono-font { font-family: 'JetBrains Mono', monospace; }

        .watermark {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-30deg);
            font-size: 8rem; font-weight: 900; color: rgba(99, 102, 241, 0.03);
            pointer-events: none; user-select: none; z-index: 0;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px;
        }

        /* Tabs */
        .tab-btn {
            @apply px-6 py-3 font-bold text-xs transition-all duration-300 border-b-2 border-transparent text-slate-400 uppercase tracking-wider;
        }
        .tab-active {
            @apply border-indigo-500 text-white bg-indigo-500/10;
        }

        /* Code Highlighting */
        .token-module { color: #c084fc; }
        .token-wire { color: #fbbf24; }
        .token-inst { color: #60a5fa; cursor: pointer; }
        .token-inst:hover { background: rgba(96, 165, 250, 0.2); }
        .token-port { color: #94a3b8; }
        .highlighted-code { background: rgba(99, 102, 241, 0.3); border-radius: 4px; }

        /* Schematic Components */
        .gate-body { fill: #1e293b; stroke: #94a3b8; stroke-width: 2; transition: all 0.3s; }
        .gate-body.active { stroke: #facc15; fill: #422006; filter: drop-shadow(0 0 5px #facc15); }
        .gate-label { font-family: 'JetBrains Mono'; font-size: 10px; fill: #cbd5e1; pointer-events: none; }
        
        .wire { fill: none; stroke: #475569; stroke-width: 2; transition: all 0.3s; stroke-linecap: round; }
        .wire.active { stroke: #facc15; filter: drop-shadow(0 0 3px #facc15); }

        /* Optimization Slider */
        input[type=range] { accent-color: #6366f1; }

        /* Theory Typography */
        .prose h1 { @apply text-3xl font-bold text-white mb-6 tech-font border-b border-slate-800 pb-2; }
        .prose h2 { @apply text-xl font-bold text-indigo-400 mt-8 mb-4 uppercase tracking-wider; }
        .prose h3 { @apply text-lg font-bold text-slate-200 mt-6 mb-2; }
        .prose p { @apply text-slate-400 mb-4 leading-relaxed text-sm; }
        .prose strong { @apply text-white font-semibold; }
        .prose ul { @apply list-disc list-inside space-y-2 text-slate-400 mb-4 text-sm; }
        .prose code { @apply bg-slate-900 px-1 py-0.5 rounded text-indigo-300 font-mono text-xs; }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
        
        .hidden { display: none !important; }
    </style>
</head>
<body class="h-screen w-screen flex flex-col relative">

    <div class="watermark">EcrioniX VLSI</div>

    <!-- Header -->
    <nav class="border-b border-slate-800 bg-slate-900/80 px-6 py-3 flex justify-between items-center z-50">
        <div class="flex items-center gap-8">
            <div>
                <h1 class="text-xl font-bold text-indigo-400 tech-font uppercase">Gate Level <span class="text-white">Netlist</span></h1>
            </div>
            <div class="flex">
                <button onclick="switchView('theory')" id="btn-theory" class="tab-btn tab-active">THEORY GUIDE</button>
                <button onclick="switchView('lab')" id="btn-lab" class="tab-btn">NETLIST EXPLORER</button>
            </div>
        </div>
        
        <button onclick="window.history.back()" class="group flex items-center text-slate-400 hover:text-white transition bg-slate-800/80 px-4 py-2 rounded-lg border border-slate-700 hover:border-indigo-500">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
            <span class="text-xs font-bold uppercase">Exit Lab</span>
        </button>
    </nav>

    <!-- Content Area -->
    <div class="flex-grow overflow-hidden relative">
        
        <!-- VIEW 1: THEORY -->
        <div id="view-theory" class="absolute inset-0 z-10 overflow-y-auto p-8 flex justify-center">
            <div class="max-w-4xl w-full glass-panel p-10 prose">
                <h1>Understanding the Gate Level Netlist</h1>
                <p>
                    In the VLSI design flow, the <strong>Gate Level Netlist</strong> is the pivotal bridge between abstract code (RTL) and physical reality (Silicon). It is the result of the <strong>Logic Synthesis</strong> process, where high-level behavioral descriptions (like Verilog `if-else` statements or `assign` blocks) are translated into a specific set of logic gates available in the foundry's standard cell library.
                </p>

                <h2>1. What is a Netlist?</h2>
                <p>
                    A netlist is essentially a text-based representation of a circuit schematic. It defines:
                </p>
                <ul>
                    <li><strong>Instances:</strong> The specific logic gates used (e.g., `AND2X1`, `DFF_X4`).</li>
                    <li><strong>Nets (Wires):</strong> The electrical connections between these instances.</li>
                    <li><strong>Ports:</strong> The primary inputs and outputs of the design.</li>
                </ul>
                <p>
                    Unlike RTL, which describes <em>what</em> the circuit does, a netlist describes <em>how</em> the circuit is built using components. It removes ambiguity and is the definitive guide for the Place and Route (PnR) tools.
                </p>

                <h2>2. Standard Cell Libraries & Drive Strength</h2>
                <p>
                    Synthesis tools map your code to a <strong>Standard Cell Library</strong>. A unique feature of netlists is the concept of <strong>Drive Strength</strong>. A simple logic function like "AND" might have multiple versions in the library:
                </p>
                <ul>
                    <li><strong>AND2_X1:</strong> Minimum size, low power, slow, drives short wires.</li>
                    <li><strong>AND2_X4:</strong> 4x larger size, higher power, fast, drives long wires or high capacitance loads.</li>
                    <li><strong>AND2_X8:</strong> Very large, used for clock trees or high-fanout nets.</li>
                </ul>
                <p>
                    The synthesis tool chooses the best size based on your timing constraints (clock frequency) and power budget.
                </p>

                <h2>3. The Synthesis Process</h2>
                <p>
                    The conversion from RTL to Netlist involves three main steps:
                </p>
                <h3>A. Translation</h3>
                <p>The tool converts Verilog keywords into generic boolean logic (GTECH). For example, `c = a + b` becomes a generic adder circuit.</p>
                
                <h3>B. Optimization</h3>
                <p>The tool manipulates the boolean logic to remove redundancy and flatten hierarchy. It tries to create the most efficient logic structure possible.</p>
                
                <h3>C. Technology Mapping</h3>
                <p>The generic logic is mapped to the specific standard cells provided by the foundry (e.g., TSMC 7nm or Intel 22nm). This is where timing arcs and wire delays are first estimated.</p>

                <h2>4. Netlist formats</h2>
                <p>
                    While Verilog (`.v`) is the most common format for netlists, you might also encounter:
                </p>
                <ul>
                    <li><strong>EDIF:</strong> Electronic Design Interchange Format (Older).</li>
                    <li><strong>VHDL:</strong> Used in some legacy or FPGA flows.</li>
                    <li><strong>SPICE:</strong> A transistor-level netlist used for analog simulation, which is even lower level than gate-level.</li>
                </ul>

                <h2>5. Gate Level Simulation (GLS)</h2>
                <p>
                    Why do we simulate the netlist if we already simulated the RTL?
                </p>
                <p>
                    RTL simulation is ideal; it assumes zero delay. <strong>Gate Level Simulation (GLS)</strong> includes timing delays. It helps catch:
                </p>
                <ul>
                    <li><strong>X-Propagation:</strong> Uninitialized states causing unknown values to ripple through the logic.</li>
                    <li><strong>Glitch Logic:</strong> Race conditions that RTL simulation misses.</li>
                    <li><strong>Timing Violations:</strong> Setup/Hold time errors on real paths.</li>
                </ul>

                <div class="mt-12 text-center">
                    <button onclick="switchView('lab')" class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-4 rounded-xl font-bold transition shadow-lg shadow-indigo-500/30">
                        OPEN NETLIST VISUALIZER &rarr;
                    </button>
                </div>
            </div>
        </div>

        <!-- VIEW 2: LAB -->
        <div id="view-lab" class="absolute inset-0 z-0 opacity-0 pointer-events-none flex p-6 gap-6 overflow-hidden">
            
            <!-- Left: Netlist Code Viewer -->
            <div class="w-1/3 flex flex-col gap-4">
                <div class="glass-panel p-1 flex-grow flex flex-col overflow-hidden relative">
                    <div class="px-4 py-2 border-b border-slate-700 bg-slate-900/50 flex justify-between items-center">
                        <span class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">synthesized_design.v</span>
                        <div class="flex items-center gap-2">
                            <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                            <span class="text-[10px] text-green-500 font-bold">Synthesized</span>
                        </div>
                    </div>
                    
                    <!-- Code Editor / Viewer -->
                    <div class="flex-grow p-4 overflow-y-auto mono-font text-xs bg-[#0b0f19] text-slate-300 leading-relaxed" id="netlist-viewer">
                        <!-- Content Injected via JS -->
                    </div>
                </div>

                <!-- Optimization Controls -->
                <div class="glass-panel p-6">
                    <h2 class="text-indigo-400 font-bold mb-4 uppercase text-[10px] tracking-widest">Synthesis Constraints</h2>
                    
                    <div class="space-y-6">
                        <div>
                            <div class="flex justify-between text-xs mb-2">
                                <span class="text-slate-300 font-bold">Optimization Goal</span>
                                <span id="opt-mode" class="text-white font-mono font-bold">BALANCED</span>
                            </div>
                            <input type="range" id="slider-opt" min="0" max="2" step="1" value="1" class="w-full">
                            <div class="flex justify-between text-[9px] text-slate-500 mt-1 uppercase font-bold">
                                <span>Area (Low Power)</span>
                                <span>Speed (Timing)</span>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4 text-xs font-mono">
                            <div class="bg-black/30 p-2 rounded border border-slate-800">
                                <div class="text-slate-500">Cell Count</div>
                                <div id="stat-cells" class="text-white text-lg">5</div>
                            </div>
                            <div class="bg-black/30 p-2 rounded border border-slate-800">
                                <div class="text-slate-500">Leakage Power</div>
                                <div id="stat-power" class="text-yellow-400 text-lg">1.2 nW</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right: Schematic Visualizer -->
            <div class="w-2/3 flex flex-col gap-6">
                <div class="glass-panel p-1 flex-grow relative overflow-hidden flex flex-col">
                    <div class="px-4 py-2 border-b border-slate-700 bg-slate-900/50 flex justify-between items-center z-10">
                        <span class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Schematic Viewer</span>
                        <div class="flex gap-4 text-[10px] font-mono text-slate-500">
                            <span>Zoom: 100%</span>
                            <span>Layer: ALL</span>
                        </div>
                    </div>

                    <div class="flex-grow bg-[#0f172a] relative overflow-hidden flex items-center justify-center cursor-move" id="schematic-container">
                        <div class="absolute inset-0 opacity-10 pointer-events-none" style="background-image: radial-gradient(#64748b 1px, transparent 1px); background-size: 20px 20px;"></div>
                        
                        <svg id="schematic-svg" width="800" height="500" viewBox="0 0 800 500">
                            <defs>
                                <!-- Standard Cell Shapes -->
                                <g id="gate-and">
                                    <path d="M0,0 V40 H25 A20,20 0 0,0 45,20 A20,20 0 0,0 25,0 H0 Z" class="gate-body" />
                                </g>
                                <g id="gate-or">
                                    <path d="M0,0 Q15,20 0,40 H10 Q50,20 10,0 H0 Z" class="gate-body" />
                                </g>
                                <g id="gate-not">
                                    <path d="M0,0 V40 L35,20 Z" class="gate-body" />
                                    <circle cx="39" cy="20" r="4" class="gate-body" />
                                </g>
                            </defs>

                            <!-- Wires Layer -->
                            <g id="layer-wires">
                                <!-- Example Wires (Dynamic update) -->
                            </g>

                            <!-- Gates Layer -->
                            <g id="layer-gates">
                                <!-- Gates injected here -->
                            </g>
                            
                            <!-- Labels -->
                            <g id="layer-labels"></g>
                        </svg>
                    </div>

                    <!-- ECO Mini-Game Overlay (Hidden initially) -->
                    <div id="eco-panel" class="absolute bottom-4 right-4 bg-slate-800 p-4 rounded-xl border border-slate-600 shadow-xl hidden w-64">
                        <h3 class="text-xs text-indigo-400 font-bold mb-2">ECO Challenge: Fix Logic</h3>
                        <p class="text-[10px] text-slate-300 mb-3">The logic for net <code>n_5</code> is inverted! Swap the buffer for an inverter to fix the bug without re-synthesis.</p>
                        <button onclick="applyECO()" class="w-full py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-xs font-bold">APPLY PATCH</button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- State ---
        let optMode = 1; // 0=Area, 1=Balanced, 2=Speed
        let highlightNet = null;
        let isEcoActive = false;

        // --- Netlist Data Model ---
        // Simple logic: Y = (A & B) | (!C)
        const netlistData = {
            area: {
                cells: [
                    { type: 'AND2_X1', name: 'u1', x: 150, y: 100, in: ['A','B'], out: 'n1' },
                    { type: 'INV_X1',  name: 'u2', x: 150, y: 250, in: ['C'], out: 'n2' },
                    { type: 'OR2_X1',  name: 'u3', x: 350, y: 175, in: ['n1','n2'], out: 'Y' }
                ],
                power: '0.8 nW', count: 3
            },
            balanced: {
                cells: [
                    { type: 'AND2_X2', name: 'u1', x: 150, y: 100, in: ['A','B'], out: 'n1' },
                    { type: 'INV_X2',  name: 'u2', x: 150, y: 250, in: ['C'], out: 'n2' },
                    { type: 'OR2_X2',  name: 'u3', x: 350, y: 175, in: ['n1','n2'], out: 'Y' }
                ],
                power: '1.2 nW', count: 3
            },
            speed: {
                cells: [
                    { type: 'AND2_X4', name: 'u1', x: 150, y: 100, in: ['A','B'], out: 'n1' },
                    { type: 'BUF_X8',  name: 'u4', x: 280, y: 100, in: ['n1'], out: 'n1_buf' }, // Repeater for speed
                    { type: 'INV_X4',  name: 'u2', x: 150, y: 250, in: ['C'], out: 'n2' },
                    { type: 'OR2_X4',  name: 'u3', x: 450, y: 175, in: ['n1_buf','n2'], out: 'Y' }
                ],
                power: '3.5 nW', count: 4
            }
        };

        // --- DOM ---
        const viewer = document.getElementById('netlist-viewer');
        const svgGateLayer = document.getElementById('layer-gates');
        const svgWireLayer = document.getElementById('layer-wires');
        const svgLabelLayer = document.getElementById('layer-labels');
        const sOpt = document.getElementById('slider-opt');

        // --- View Logic ---
        function switchView(v) {
            const theory = document.getElementById('view-theory');
            const lab = document.getElementById('view-lab');
            const btnT = document.getElementById('btn-theory');
            const btnL = document.getElementById('btn-lab');

            if (v === 'theory') {
                theory.classList.remove('opacity-0', 'pointer-events-none'); theory.classList.add('z-10');
                lab.classList.add('opacity-0', 'pointer-events-none'); lab.classList.remove('z-10');
                btnT.classList.add('tab-active'); btnL.classList.remove('tab-active');
            } else {
                lab.classList.remove('opacity-0', 'pointer-events-none'); lab.classList.add('z-10');
                theory.classList.add('opacity-0', 'pointer-events-none'); theory.classList.remove('z-10');
                btnL.classList.add('tab-active'); btnT.classList.remove('tab-active');
                renderNetlist();
            }
        }

        // --- Simulation Logic ---
        sOpt.addEventListener('input', (e) => {
            optMode = parseInt(e.target.value);
            const modes = ["AREA (Low Power)", "BALANCED", "SPEED (High Perf)"];
            document.getElementById('opt-mode').innerText = modes[optMode];
            
            // Update mode coloring
            if(optMode === 0) document.getElementById('opt-mode').className = "text-green-400 font-mono font-bold";
            else if(optMode === 2) document.getElementById('opt-mode').className = "text-red-400 font-mono font-bold";
            else document.getElementById('opt-mode').className = "text-white font-mono font-bold";

            renderNetlist();
        });

        function getCurrentData() {
            if (optMode === 0) return netlistData.area;
            if (optMode === 2) return netlistData.speed;
            return netlistData.balanced;
        }

        function renderNetlist() {
            const data = getCurrentData();
            
            // Update Stats
            document.getElementById('stat-cells').innerText = data.count;
            document.getElementById('stat-power').innerText = data.power;

            // 1. Render Text Netlist
            let html = `<div class="mb-2"><span class="token-module">module</span> top (A, B, C, Y);</div>`;
            html += `<div class="pl-4"><span class="token-module">input</span> A, B, C;</div>`;
            html += `<div class="pl-4"><span class="token-module">output</span> Y;</div>`;
            html += `<div class="pl-4"><span class="token-wire">wire</span> n1, n2;</div><br>`;

            data.cells.forEach(cell => {
                // Generate port map string .A(n1)
                const ports = cell.in.map((n, i) => `.<span class="token-port">I${i}</span>(${n})`).join(', ');
                const out = `.<span class="token-port">Z</span>(${cell.out})`;
                
                html += `<div class="pl-4 hover:bg-white/5 cursor-pointer rounded" onmouseenter="highlightGate('${cell.name}')" onmouseleave="clearHighlight()">`;
                html += `  <span class="token-inst font-bold">${cell.type}</span> ${cell.name} (${ports}, ${out});`;
                html += `</div>`;
            });

            html += `<div class="mt-2"><span class="token-module">endmodule</span></div>`;
            viewer.innerHTML = html;

            // 2. Render Schematic
            renderSchematic(data);
        }

        function renderSchematic(data) {
            svgGateLayer.innerHTML = '';
            svgWireLayer.innerHTML = '';
            svgLabelLayer.innerHTML = '';

            // Draw Gates
            data.cells.forEach(cell => {
                const group = document.createElementNS("http://www.w3.org/2000/svg", "g");
                group.setAttribute("transform", `translate(${cell.x}, ${cell.y})`);
                group.setAttribute("id", `sch-${cell.name}`);
                
                // Determine shape
                let useId = '#gate-and';
                if (cell.type.includes('OR')) useId = '#gate-or';
                if (cell.type.includes('INV')) useId = '#gate-not';
                if (cell.type.includes('BUF')) useId = '#gate-and'; // reusing shape for simplicity

                // Scale based on drive strength
                let scale = 1.0;
                if (cell.type.includes('X4')) scale = 1.2;
                if (cell.type.includes('X8')) scale = 1.4;

                const use = document.createElementNS("http://www.w3.org/2000/svg", "use");
                use.setAttribute("href", useId);
                use.setAttribute("transform", `scale(${scale})`);
                use.setAttribute("class", "gate-body");
                
                // Label
                const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                text.setAttribute("x", 0);
                text.setAttribute("y", -10);
                text.setAttribute("class", "gate-label");
                text.textContent = `${cell.name} (${cell.type})`;

                group.appendChild(use);
                group.appendChild(text);
                svgGateLayer.appendChild(group);
            });

            // Draw Wires (Simplified direct connections for demo)
            // A real router is complex, we just draw lines between known coordinates for this static topology
            
            // Wire A/B to U1
            drawWire(50, 105, 150, 105); // A
            drawWire(50, 125, 150, 125); // B
            
            // Wire C to U2
            drawWire(50, 270, 150, 270); // C

            if (optMode === 2) {
                // Speed Mode (Has Buffer)
                drawWire(190, 120, 280, 120); // U1 -> U4
                drawWire(330, 120, 450, 185); // U4 -> U3
                drawWire(190, 270, 450, 205); // U2 -> U3
                drawWire(500, 200, 600, 200); // U3 -> Y
            } else {
                // Normal Modes
                drawWire(175, 120, 350, 185); // U1 -> U3
                drawWire(190, 270, 350, 205); // U2 -> U3
                drawWire(400, 200, 600, 200); // U3 -> Y
            }
        }

        function drawWire(x1, y1, x2, y2) {
            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            // Simple manhattan routing
            const midX = (x1 + x2) / 2;
            const d = `M${x1},${y1} L${midX},${y1} L${midX},${y2} L${x2},${y2}`;
            path.setAttribute("d", d);
            path.setAttribute("class", "wire");
            svgWireLayer.appendChild(path);
        }

        // --- Interaction ---
        function highlightGate(name) {
            const el = document.getElementById(`sch-${name}`);
            if (el) {
                el.querySelector('.gate-body').classList.add('active');
            }
        }

        function clearHighlight() {
            document.querySelectorAll('.gate-body').forEach(el => el.classList.remove('active'));
        }

        // Init
        renderNetlist();

    </script>
</body>
</html>
