<!DOCTYPE html>
<html lang="en">
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6672302762343789"
     crossorigin="anonymous"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZS8C1FLY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XXZS8C1FLY');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shift Register Lab - EcrioniX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Orbitron:wght@500;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #020617; color: #f8fafc; overflow: hidden; }
        .tech-font { font-family: 'Orbitron', sans-serif; }
        .mono-font { font-family: 'JetBrains Mono', monospace; }

        .watermark {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-30deg);
            font-size: 8rem; font-weight: 900; color: rgba(99, 102, 241, 0.03);
            pointer-events: none; user-select: none; z-index: 0;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px;
        }

        /* Register Components */
        .ff-box { fill: #1e293b; stroke: #94a3b8; stroke-width: 2; transition: all 0.3s; }
        .ff-active { stroke: #fbbf24; fill: #422006; } /* Active High */
        .ff-text { font-family: 'JetBrains Mono', monospace; fill: #cbd5e1; font-size: 12px; }
        .bit-val { font-family: 'Orbitron', sans-serif; fill: #fff; font-size: 18px; font-weight: bold; }

        /* Wires */
        .wire { fill: none; stroke: #475569; stroke-width: 3; stroke-linecap: round; transition: stroke 0.2s; }
        .wire-active { stroke: #fbbf24; filter: drop-shadow(0 0 4px #fbbf24); }
        .wire-clock { stroke: #facc15; }

        /* Mode Tabs */
        .tab-btn { @apply px-4 py-2 text-xs font-bold rounded-lg border border-slate-700 bg-slate-800 text-slate-400 hover:bg-slate-700 transition; }
        .tab-active { @apply bg-indigo-600 text-white border-indigo-500 shadow-lg shadow-indigo-500/30; }

        /* LED */
        .led { width: 12px; height: 12px; border-radius: 50%; background: #334155; transition: all 0.2s; border: 1px solid #475569; }
        .led-on { background: #4ade80; box-shadow: 0 0 8px #4ade80; border-color: #86efac; }
    </style>
</head>
<body class="h-screen w-screen flex flex-col relative">

    <div class="watermark">EcrioniX Logic</div>

    <!-- Header -->
    <nav class="border-b border-slate-800 bg-slate-900/80 px-6 py-4 flex justify-between items-center z-20">
        <div>
            <h1 class="text-2xl font-bold text-indigo-400 tech-font uppercase">SHIFT <span class="text-white">REGISTER</span></h1>
            <p class="text-[10px] text-slate-500 uppercase tracking-widest font-bold">Sequential Logic Simulation</p>
        </div>
        
        <div class="flex gap-2">
            <button onclick="setMode('SISO')" id="btn-siso" class="tab-btn tab-active">SISO</button>
            <button onclick="setMode('SIPO')" id="btn-sipo" class="tab-btn">SIPO</button>
            <button onclick="setMode('PISO')" id="btn-piso" class="tab-btn">PISO</button>
            <button onclick="setMode('PIPO')" id="btn-pipo" class="tab-btn">PIPO</button>
        </div>

        <button onclick="window.history.back()" class="group flex items-center text-slate-400 hover:text-white transition bg-slate-800/80 px-4 py-2 rounded-lg border border-slate-700 hover:border-indigo-500">
            <span class="text-xs font-bold uppercase">Exit Lab</span>
        </button>
    </nav>

    <!-- Main Content -->
    <div class="flex-grow flex p-6 gap-6 z-10 overflow-hidden">
        
        <!-- Left: Controls & Info -->
        <div class="w-80 flex flex-col gap-6">
            <div class="glass-panel p-6">
                <h2 class="text-indigo-400 font-bold mb-4 text-xs uppercase tracking-widest">Input Controls</h2>
                
                <!-- Serial Inputs -->
                <div id="ctrl-serial" class="space-y-4">
                    <div class="flex justify-between text-xs mb-1 text-slate-300">
                        <span>Serial Data In (DIN)</span>
                        <span id="val-din" class="font-mono text-yellow-400 font-bold">0</span>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="setSerialInput(0)" class="flex-1 py-2 bg-slate-800 border border-slate-600 rounded hover:bg-slate-700 text-xs font-bold text-white">0</button>
                        <button onclick="setSerialInput(1)" class="flex-1 py-2 bg-slate-800 border border-slate-600 rounded hover:bg-slate-700 text-xs font-bold text-white">1</button>
                    </div>
                </div>

                <!-- Parallel Inputs -->
                <div id="ctrl-parallel" class="space-y-4 hidden mt-4 pt-4 border-t border-slate-700">
                    <div class="text-xs mb-1 text-slate-300">Parallel Data Load (D3-D0)</div>
                    <div class="grid grid-cols-4 gap-2">
                        <button onclick="toggleParallel(3)" id="btn-p3" class="py-2 bg-slate-800 border border-slate-600 rounded text-xs font-bold text-slate-400">0</button>
                        <button onclick="toggleParallel(2)" id="btn-p2" class="py-2 bg-slate-800 border border-slate-600 rounded text-xs font-bold text-slate-400">0</button>
                        <button onclick="toggleParallel(1)" id="btn-p1" class="py-2 bg-slate-800 border border-slate-600 rounded text-xs font-bold text-slate-400">0</button>
                        <button onclick="toggleParallel(0)" id="btn-p0" class="py-2 bg-slate-800 border border-slate-600 rounded text-xs font-bold text-slate-400">0</button>
                    </div>
                    <button onclick="loadParallel()" class="w-full py-2 bg-emerald-600 hover:bg-emerald-500 text-white font-bold rounded shadow text-xs mt-2">LOAD PARALLEL</button>
                </div>

                <!-- Clock -->
                <div class="mt-6 pt-4 border-t border-slate-700">
                    <button onclick="pulseClock()" class="w-full py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl shadow-lg transition active:scale-95 border-b-4 border-indigo-800 active:border-b-0 active:translate-y-1">
                        CLOCK PULSE (Clk)
                    </button>
                </div>
                
                <button onclick="resetLab()" class="mt-4 w-full py-2 text-xs font-bold text-red-400 border border-red-900/30 rounded hover:bg-red-900/10">CLEAR REGISTERS</button>
            </div>

            <div class="glass-panel p-6 flex-grow overflow-y-auto">
                <h2 id="mode-title" class="text-white font-bold mb-2 uppercase text-sm tracking-wider">SISO Mode</h2>
                <p id="mode-desc" class="text-xs text-slate-400 leading-relaxed">
                    Data enters the register serially (bit-by-bit) and shifts one position to the right on every clock pulse. Data is read out serially from the last flip-flop.
                </p>
                
                <div class="mt-6 bg-slate-900/50 p-3 rounded border border-slate-700">
                    <div class="text-[10px] text-slate-500 uppercase mb-2">Register Content</div>
                    <div class="flex justify-center gap-2 font-mono text-xl font-bold text-white">
                        <span id="reg-3">0</span>
                        <span id="reg-2">0</span>
                        <span id="reg-1">0</span>
                        <span id="reg-0">0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Center: Visualization -->
        <div class="flex-grow glass-panel relative flex flex-col p-1 overflow-hidden">
            <div class="absolute top-4 left-4 z-10 px-3 py-1 bg-black/60 rounded text-[10px] text-slate-400 border border-slate-700 font-bold uppercase tracking-widest">
                4-Bit D-Flip Flop Chain
            </div>

            <div class="flex-grow flex items-center justify-center relative">
                <svg id="schematic" width="800" height="400" viewBox="0 0 800 400">
                    
                    <!-- Wiring Layer (Behind FFs) -->
                    <!-- Clock Line -->
                    <path d="M50,350 H700" class="wire" stroke="#334155" stroke-dasharray="5,5" />
                    <line x1="140" y1="350" x2="140" y2="300" class="wire" /> <!-- FF3 Clk -->
                    <line x1="290" y1="350" x2="290" y2="300" class="wire" /> <!-- FF2 Clk -->
                    <line x1="440" y1="350" x2="440" y2="300" class="wire" /> <!-- FF1 Clk -->
                    <line x1="590" y1="350" x2="590" y2="300" class="wire" /> <!-- FF0 Clk -->
                    <text x="30" y="355" fill="#facc15" font-size="12" font-weight="bold">CLK</text>

                    <!-- Serial Data Path (Shift Logic) -->
                    <g id="wires-serial">
                        <line id="w-din" x1="50" y1="230" x2="100" y2="230" class="wire" /> <!-- DIN to FF3 -->
                        <line id="w-3-2" x1="180" y1="230" x2="250" y2="230" class="wire" /> <!-- Q3 to D2 -->
                        <line id="w-2-1" x1="330" y1="230" x2="400" y2="230" class="wire" /> <!-- Q2 to D1 -->
                        <line id="w-1-0" x1="480" y1="230" x2="550" y2="230" class="wire" /> <!-- Q1 to D0 -->
                        <line id="w-out" x1="630" y1="230" x2="750" y2="230" class="wire" /> <!-- Q0 to OUT -->
                    </g>

                    <!-- Parallel Input Lines (Vertical) -->
                    <g id="wires-parallel" opacity="0">
                        <line id="w-p3" x1="140" y1="50" x2="140" y2="200" class="wire" />
                        <line id="w-p2" x1="290" y1="50" x2="290" y2="200" class="wire" />
                        <line id="w-p1" x1="440" y1="50" x2="440" y2="200" class="wire" />
                        <line id="w-p0" x1="590" y1="50" x2="590" y2="200" class="wire" />
                        <text x="140" y="40" text-anchor="middle" class="ff-text">D3</text>
                        <text x="290" y="40" text-anchor="middle" class="ff-text">D2</text>
                        <text x="440" y="40" text-anchor="middle" class="ff-text">D1</text>
                        <text x="590" y="40" text-anchor="middle" class="ff-text">D0</text>
                    </g>
                    
                    <!-- Parallel Output Lines (Vertical Down) -->
                    <g id="wires-pout" opacity="0">
                        <line x1="170" y1="230" x2="170" y2="300" class="wire" id="w-po3" />
                        <line x1="320" y1="230" x2="320" y2="300" class="wire" id="w-po2" />
                        <line x1="470" y1="230" x2="470" y2="300" class="wire" id="w-po1" />
                        <line x1="620" y1="230" x2="620" y2="300" class="wire" id="w-po0" />
                        
                        <!-- LEDs -->
                        <circle cx="170" cy="310" r="6" id="led-3" fill="#334155" />
                        <circle cx="320" cy="310" r="6" id="led-2" fill="#334155" />
                        <circle cx="470" cy="310" r="6" id="led-1" fill="#334155" />
                        <circle cx="620" cy="310" r="6" id="led-0" fill="#334155" />
                    </g>


                    <!-- Flip Flops (Inlined SVG for better control) -->
                    <g transform="translate(100, 200)" id="ff-3">
                        <rect x="0" y="0" width="80" height="100" class="ff-box" rx="4" />
                        <text x="10" y="25" class="ff-text">D</text>
                        <text x="60" y="25" class="ff-text">Q</text>
                        <text x="40" y="90" text-anchor="middle" class="ff-text" font-size="10">CLK</text>
                        <path d="M35,100 L40,90 L45,100" fill="none" stroke="#94a3b8" />
                        <text x="40" y="55" text-anchor="middle" class="bit-val" id="val-3">0</text>
                        <text x="40" y="-10" text-anchor="middle" class="ff-text" fill="#60a5fa">FF3</text>
                    </g>

                    <g transform="translate(250, 200)" id="ff-2">
                        <rect x="0" y="0" width="80" height="100" class="ff-box" rx="4" />
                        <text x="10" y="25" class="ff-text">D</text>
                        <text x="60" y="25" class="ff-text">Q</text>
                        <text x="40" y="90" text-anchor="middle" class="ff-text" font-size="10">CLK</text>
                        <path d="M35,100 L40,90 L45,100" fill="none" stroke="#94a3b8" />
                        <text x="40" y="55" text-anchor="middle" class="bit-val" id="val-2">0</text>
                        <text x="40" y="-10" text-anchor="middle" class="ff-text" fill="#60a5fa">FF2</text>
                    </g>

                    <g transform="translate(400, 200)" id="ff-1">
                        <rect x="0" y="0" width="80" height="100" class="ff-box" rx="4" />
                        <text x="10" y="25" class="ff-text">D</text>
                        <text x="60" y="25" class="ff-text">Q</text>
                        <text x="40" y="90" text-anchor="middle" class="ff-text" font-size="10">CLK</text>
                        <path d="M35,100 L40,90 L45,100" fill="none" stroke="#94a3b8" />
                        <text x="40" y="55" text-anchor="middle" class="bit-val" id="val-1">0</text>
                        <text x="40" y="-10" text-anchor="middle" class="ff-text" fill="#60a5fa">FF1</text>
                    </g>

                    <g transform="translate(550, 200)" id="ff-0">
                        <rect x="0" y="0" width="80" height="100" class="ff-box" rx="4" />
                        <text x="10" y="25" class="ff-text">D</text>
                        <text x="60" y="25" class="ff-text">Q</text>
                        <text x="40" y="90" text-anchor="middle" class="ff-text" font-size="10">CLK</text>
                        <path d="M35,100 L40,90 L45,100" fill="none" stroke="#94a3b8" />
                        <text x="40" y="55" text-anchor="middle" class="bit-val" id="val-0">0</text>
                        <text x="40" y="-10" text-anchor="middle" class="ff-text" fill="#60a5fa">FF0</text>
                    </g>
                    
                    <text x="10" y="235" class="ff-text" id="lbl-din" fill="#fbbf24">DIN</text>
                    <text x="760" y="235" class="ff-text" id="lbl-dout" fill="#4ade80">SOUT</text>

                </svg>
            </div>
        </div>

    </div>

    <script>
        // --- State ---
        let mode = 'SISO';
        let registers = [0, 0, 0, 0]; // Q3, Q2, Q1, Q0
        let serialIn = 0;
        let parallelIn = [0, 0, 0, 0]; // D3, D2, D1, D0

        // --- View Logic ---
        function setMode(m) {
            mode = m;
            document.querySelectorAll('.tab-btn').forEach(b => {
                if(b.id === `btn-${m.toLowerCase()}`) b.classList.add('tab-active');
                else b.classList.remove('tab-active');
            });

            const serialCtrl = document.getElementById('ctrl-serial');
            const parallelCtrl = document.getElementById('ctrl-parallel');
            
            const wiresSerial = document.getElementById('wires-serial');
            const wiresParallel = document.getElementById('wires-parallel');
            const wiresPout = document.getElementById('wires-pout');
            
            const title = document.getElementById('mode-title');
            const desc = document.getElementById('mode-desc');

            // Reset visibility
            serialCtrl.classList.add('hidden');
            parallelCtrl.classList.add('hidden');
            wiresSerial.style.opacity = '0';
            wiresParallel.style.opacity = '0';
            wiresPout.style.opacity = '0';
            
            // Mode Specifics
            if (m === 'SISO') {
                title.innerText = "SISO Mode";
                desc.innerText = "Serial In - Serial Out. Data is shifted in one bit at a time and shifted out one bit at a time. Used for data transmission.";
                serialCtrl.classList.remove('hidden');
                wiresSerial.style.opacity = '1';
                document.getElementById('lbl-dout').style.opacity = '1';
            } else if (m === 'SIPO') {
                title.innerText = "SIPO Mode";
                desc.innerText = "Serial In - Parallel Out. Data is shifted in serially, but all bits are read simultaneously. Used for SerDes (Deserializer).";
                serialCtrl.classList.remove('hidden');
                wiresSerial.style.opacity = '1'; // Shift logic still needed
                wiresPout.style.opacity = '1';
                document.getElementById('lbl-dout').style.opacity = '0'; // No serial out focus
            } else if (m === 'PISO') {
                title.innerText = "PISO Mode";
                desc.innerText = "Parallel In - Serial Out. Data is loaded instantly into all flips-flops, then shifted out serially. Used for Serializers.";
                parallelCtrl.classList.remove('hidden');
                // PISO needs shift logic wires for the output phase
                wiresSerial.style.opacity = '1'; 
                wiresParallel.style.opacity = '1'; // Visual for loading
                document.getElementById('lbl-dout').style.opacity = '1';
            } else {
                // PIPO
                title.innerText = "PIPO Mode";
                desc.innerText = "Parallel In - Parallel Out. Acts as a buffer register. Data is loaded and read instantly.";
                parallelCtrl.classList.remove('hidden');
                wiresParallel.style.opacity = '1';
                wiresPout.style.opacity = '1';
                document.getElementById('lbl-dout').style.opacity = '0';
            }
            
            updateVisuals();
        }

        // --- Interactions ---
        function setSerialInput(val) {
            serialIn = val;
            document.getElementById('val-din').innerText = val;
            updateVisuals();
        }

        function toggleParallel(idx) {
            parallelIn[idx] = parallelIn[idx] ? 0 : 1;
            const btn = document.getElementById(`btn-p${idx}`);
            btn.innerText = parallelIn[idx];
            if (parallelIn[idx]) {
                btn.className = "py-2 bg-green-600 border border-green-500 rounded text-xs font-bold text-white shadow";
            } else {
                btn.className = "py-2 bg-slate-800 border border-slate-600 rounded text-xs font-bold text-slate-400";
            }
        }

        function loadParallel() {
            if (mode === 'PISO' || mode === 'PIPO') {
                registers = [...parallelIn]; // D3->Q3 ... D0->Q0
                updateVisuals();
            }
        }

        function pulseClock() {
            if (mode === 'SISO' || mode === 'SIPO') {
                // Shift Right: Q0=Q1, Q1=Q2, Q2=Q3, Q3=DIN
                // registers[0] = registers[1]
                // registers[3] = serialIn
                
                // Copy array logic
                for(let i=0; i<3; i++) {
                    registers[i] = registers[i+1];
                }
                registers[3] = serialIn;
                
            } else if (mode === 'PISO') {
                // Shift logic active after load
                for(let i=0; i<3; i++) {
                    registers[i] = registers[i+1];
                }
                registers[3] = 0; // Padding with 0s for PISO shift out
            }
            // PIPO clock usually updates from D inputs (Load), handled by "Load" button conceptually here for clarity.
            // But strict PIPO updates on clock. Let's assume Load parallel is async set or Muxed input.
            // For simplicity in this lab: Load Parallel button sets state immediately (Async Load). Clock shifts (for S/P ISO).
            
            updateVisuals();
        }
        
        function resetLab() {
            registers = [0,0,0,0];
            updateVisuals();
        }

        // --- Rendering ---
        function updateVisuals() {
            // Update Register Text
            for(let i=0; i<4; i++) {
                document.getElementById(`reg-${i}`).innerText = registers[i];
                document.getElementById(`val-${i}`).innerText = registers[i];
                
                // Highlight FF Body if 1
                const ff = document.getElementById(`ff-${i}`).querySelector('rect');
                if (registers[i]) ff.classList.add('ff-active');
                else ff.classList.remove('ff-active');
            }

            // Update Wires (SISO/SIPO/PISO)
            // DIN Wire
            const wDin = document.getElementById('w-din');
            if (serialIn) wDin.classList.add('wire-active'); else wDin.classList.remove('wire-active');

            // Internal Shift Wires (Q -> D)
            // w-3-2 connects Q3 to D2. So it carries Q3's value.
            const w32 = document.getElementById('w-3-2');
            if (registers[3]) w32.classList.add('wire-active'); else w32.classList.remove('wire-active');

            const w21 = document.getElementById('w-2-1');
            if (registers[2]) w21.classList.add('wire-active'); else w21.classList.remove('wire-active');
            
            const w10 = document.getElementById('w-1-0');
            if (registers[1]) w10.classList.add('wire-active'); else w10.classList.remove('wire-active');

            const wOut = document.getElementById('w-out');
            if (registers[0]) wOut.classList.add('wire-active'); else wOut.classList.remove('wire-active');

            // Parallel Input Wires
            for(let i=0; i<4; i++) {
                const w = document.getElementById(`w-p${i}`);
                if (parallelIn[i]) w.classList.add('wire-active'); else w.classList.remove('wire-active');
            }
            
            // Parallel Output Wires & LEDs
            for(let i=0; i<4; i++) {
                const w = document.getElementById(`w-po${i}`);
                const led = document.getElementById(`led-${i}`);
                if (registers[i]) {
                    w.classList.add('wire-active');
                    led.setAttribute('fill', '#4ade80');
                    led.setAttribute('filter', 'drop-shadow(0 0 4px #4ade80)');
                } else {
                    w.classList.remove('wire-active');
                    led.setAttribute('fill', '#334155');
                    led.setAttribute('filter', 'none');
                }
            }
        }

        // Init
        setMode('SISO');
        updateVisuals();

    </script>
</body>
</html>
