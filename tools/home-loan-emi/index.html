<!DOCTYPE html>
<html lang="en">
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6672302762343789"
     crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZS8C1FLY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XXZS8C1FLY');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcrioniX Loan Analyst</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Custom range slider styling */
        input[type=range] {
            -webkit-appearance: none; 
            background: transparent; 
        }
        
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
            margin-top: -8px; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #e0e7ff;
            border-radius: 2px;
        }

        /* Hide number input spinners */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans min-h-screen flex flex-col">

    <!-- Header -->
    <div class="bg-indigo-700 text-white p-6 shadow-lg">
        <div class="max-w-4xl mx-auto flex flex-col md:flex-row md:justify-between md:items-center gap-4">
            <div>
                <h1 class="text-2xl font-bold flex items-center gap-2">
                    <i data-lucide="calculator" class="w-8 h-8"></i>
                    EcrioniX Loan Analyst
                </h1>
                <p class="text-indigo-200 text-sm mt-1">Calculate EMI & Compare Interest Scenarios</p>
            </div>
            <div class="flex items-center gap-2 bg-indigo-800 px-4 py-2 rounded-lg border border-indigo-600 shadow-sm">
                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                <span class="text-xs font-bold tracking-wider text-indigo-100 uppercase">EcrioniX Financial Tools</span>
            </div>
        </div>
    </div>

    <div class="max-w-4xl mx-auto px-4 mt-6 w-full flex-grow pb-12">
        
        <!-- Tabs -->
        <div class="flex space-x-2 mb-6">
            <button onclick="switchTab('calculator')" id="tab-calculator" class="flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 bg-white text-indigo-700 shadow-md ring-1 ring-indigo-100">
                <i data-lucide="calculator" class="w-5 h-5"></i>
                Basic Calculator
            </button>
            <button onclick="switchTab('compare')" id="tab-compare" class="flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 bg-gray-200 text-gray-500 hover:bg-gray-300">
                <i data-lucide="trending-up" class="w-5 h-5"></i>
                Compare Scenarios
            </button>
        </div>

        <!-- BASIC CALCULATOR VIEW -->
        <div id="view-calculator" class="grid md:grid-cols-2 gap-6">
            
            <!-- Input Section -->
            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                <h2 class="text-lg font-semibold mb-6 text-gray-700 border-b pb-2">Loan Details</h2>
                
                <!-- Principal Amount -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-600 mb-2 flex items-center gap-2">
                        <i data-lucide="dollar-sign" class="w-4 h-4"></i> Loan Amount
                    </label>
                    <input type="range" id="input-principal-range" min="100000" max="50000000" step="100000" value="5000000" class="w-full mb-2">
                    <div class="flex items-center bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 focus-within:ring-2 focus-within:ring-indigo-500">
                        <span class="text-gray-500 mr-2">₹</span>
                        <input type="number" id="input-principal-text" value="5000000" class="bg-transparent w-full outline-none font-semibold text-gray-800">
                    </div>
                </div>

                <!-- Interest Rate -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-600 mb-2 flex items-center gap-2">
                        <i data-lucide="percent" class="w-4 h-4"></i> Interest Rate (% p.a)
                    </label>
                    <input type="range" id="input-rate-range" min="1" max="20" step="0.1" value="8.5" class="w-full mb-2">
                    <div class="flex items-center bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 focus-within:ring-2 focus-within:ring-indigo-500">
                        <input type="number" id="input-rate-text" value="8.5" class="bg-transparent w-full outline-none font-semibold text-gray-800">
                        <span class="text-gray-500 ml-2">%</span>
                    </div>
                </div>

                <!-- Tenure -->
                <div class="mb-2">
                    <label class="block text-sm font-medium text-gray-600 mb-2 flex items-center gap-2">
                        <i data-lucide="calendar" class="w-4 h-4"></i> Loan Tenure (Years)
                    </label>
                    <input type="range" id="input-years-range" min="1" max="30" step="1" value="20" class="w-full mb-2">
                    <div class="flex items-center bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 focus-within:ring-2 focus-within:ring-indigo-500">
                        <input type="number" id="input-years-text" value="20" class="bg-transparent w-full outline-none font-semibold text-gray-800">
                        <span class="text-gray-500 ml-2">Years</span>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col justify-between">
                <div>
                    <h2 class="text-lg font-semibold mb-6 text-gray-700 border-b pb-2">Repayment Summary</h2>
                    
                    <div class="bg-indigo-50 rounded-xl p-6 text-center mb-6">
                        <p class="text-indigo-600 font-medium text-sm uppercase tracking-wide mb-1">Monthly EMI</p>
                        <p id="result-emi" class="text-4xl font-bold text-indigo-900">₹0</p>
                    </div>

                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="p-3 bg-gray-50 rounded-lg">
                            <p class="text-gray-500 text-xs mb-1">Principal Amount</p>
                            <p id="result-principal" class="font-bold text-gray-800">₹0</p>
                        </div>
                        <div class="p-3 bg-red-50 rounded-lg border border-red-100">
                            <p class="text-red-500 text-xs mb-1">Total Interest</p>
                            <p id="result-interest" class="font-bold text-red-800">₹0</p>
                        </div>
                        <div class="col-span-2 p-3 bg-gray-50 rounded-lg border border-gray-200">
                            <p class="text-gray-500 text-xs mb-1">Total Amount Payable</p>
                            <p id="result-total" class="font-bold text-gray-900">₹0</p>
                        </div>
                    </div>
                </div>

                <!-- Pie Chart -->
                <div class="flex flex-col items-center justify-center p-4">
                    <div id="chart-donut" class="w-40 h-40 rounded-full mb-4 relative transition-all duration-500">
                        <div class="absolute inset-4 bg-white rounded-full flex items-center justify-center">
                            <span class="text-gray-500 text-xs font-semibold">Distribution</span>
                        </div>
                    </div>
                    <div class="flex gap-4 text-sm">
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 bg-indigo-600 rounded-full"></div>
                            <span id="legend-principal">Principal</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                            <span id="legend-interest">Interest</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- COMPARISON VIEW -->
        <div id="view-compare" class="hidden space-y-6">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3">
                <div class="bg-blue-100 p-2 rounded-full text-blue-600">
                    <i data-lucide="refresh-cw" class="w-5 h-5"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-blue-900">Scenario Analysis</h3>
                    <p class="text-sm text-blue-700">
                        Add different scenarios below to compare how interest rates and tenure impact your total cost.
                    </p>
                </div>
            </div>

            <!-- Scenarios Grid -->
            <div id="scenarios-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Scenarios will be injected here via JS -->
            </div>
             <!-- Add Button will be appended here via JS -->
             
             <!-- Comparison Table -->
             <div id="comparison-table-container" class="hidden bg-white rounded-xl shadow-sm border border-gray-200 p-6 overflow-x-auto mt-6">
                <h3 class="font-bold text-gray-700 mb-4">Quick Comparison</h3>
                <table class="w-full text-left text-sm">
                    <thead>
                        <tr class="border-b border-gray-100">
                            <th class="pb-3 text-gray-500 font-medium">Scenario</th>
                            <th class="pb-3 text-gray-500 font-medium">Interest Rate</th>
                            <th class="pb-3 text-gray-500 font-medium">Tenure</th>
                            <th class="pb-3 text-indigo-600 font-bold">Monthly EMI</th>
                            <th class="pb-3 text-red-500 font-bold">Total Interest</th>
                        </tr>
                    </thead>
                    <tbody id="comparison-table-body">
                        <!-- Table rows injected via JS -->
                    </tbody>
                </table>
             </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // State
        let currentTab = 'calculator';
        
        let calculatorState = {
            principal: 5000000,
            rate: 8.5,
            years: 20
        };

        let scenarios = [
            { id: 1, amount: 5000000, interest: 8.5, tenure: 20 }
        ];

        // Format Currency Helper
        const formatCurrency = (value) => {
            return new Intl.NumberFormat('en-IN', {
                style: 'currency',
                currency: 'INR',
                maximumFractionDigits: 0,
            }).format(value);
        };

        // Calculation Logic
        const calculateEMI = (p, r, n) => {
            if (p === 0 || r === 0 || n === 0) return { emi: 0, totalInterest: 0, totalPayment: 0 };
            
            const monthlyRate = r / 12 / 100;
            const months = n * 12;
            
            const emi = (p * monthlyRate * Math.pow(1 + monthlyRate, months)) / (Math.pow(1 + monthlyRate, months) - 1);
            const totalPayment = emi * months;
            const totalInterest = totalPayment - p;

            return {
                emi: Math.round(emi),
                totalInterest: Math.round(totalInterest),
                totalPayment: Math.round(totalPayment)
            };
        };

        // DOM Elements - Calculator
        const inputs = {
            principalRange: document.getElementById('input-principal-range'),
            principalText: document.getElementById('input-principal-text'),
            rateRange: document.getElementById('input-rate-range'),
            rateText: document.getElementById('input-rate-text'),
            yearsRange: document.getElementById('input-years-range'),
            yearsText: document.getElementById('input-years-text'),
        };

        const results = {
            emi: document.getElementById('result-emi'),
            principal: document.getElementById('result-principal'),
            interest: document.getElementById('result-interest'),
            total: document.getElementById('result-total'),
            chart: document.getElementById('chart-donut'),
            legendPrincipal: document.getElementById('legend-principal'),
            legendInterest: document.getElementById('legend-interest'),
        };

        // --- Functions for Basic Calculator ---

        function updateCalculatorUI() {
            // Sync inputs (ensure range and text match)
            inputs.principalRange.value = calculatorState.principal;
            inputs.principalText.value = calculatorState.principal;
            inputs.rateRange.value = calculatorState.rate;
            inputs.rateText.value = calculatorState.rate;
            inputs.yearsRange.value = calculatorState.years;
            inputs.yearsText.value = calculatorState.years;

            // Calculate
            const data = calculateEMI(calculatorState.principal, calculatorState.rate, calculatorState.years);

            // Update Text
            results.emi.textContent = formatCurrency(data.emi);
            results.principal.textContent = formatCurrency(calculatorState.principal);
            results.interest.textContent = formatCurrency(data.totalInterest);
            results.total.textContent = formatCurrency(data.totalPayment);

            // Update Chart
            const total = calculatorState.principal + data.totalInterest;
            const pPercent = (calculatorState.principal / total) * 100;
            const iPercent = (data.totalInterest / total) * 100;

            results.chart.style.background = `conic-gradient(#4f46e5 ${pPercent}%, #ef4444 0)`;
            results.legendPrincipal.textContent = `Principal (${Math.round(pPercent)}%)`;
            results.legendInterest.textContent = `Interest (${Math.round(iPercent)}%)`;
        }

        function setupCalculatorListeners() {
            // Principal
            const updatePrincipal = (val) => { calculatorState.principal = Number(val); updateCalculatorUI(); };
            inputs.principalRange.addEventListener('input', (e) => updatePrincipal(e.target.value));
            inputs.principalText.addEventListener('input', (e) => updatePrincipal(e.target.value));

            // Rate
            const updateRate = (val) => { calculatorState.rate = Number(val); updateCalculatorUI(); };
            inputs.rateRange.addEventListener('input', (e) => updateRate(e.target.value));
            inputs.rateText.addEventListener('input', (e) => updateRate(e.target.value));

            // Years
            const updateYears = (val) => { calculatorState.years = Number(val); updateCalculatorUI(); };
            inputs.yearsRange.addEventListener('input', (e) => updateYears(e.target.value));
            inputs.yearsText.addEventListener('input', (e) => updateYears(e.target.value));
        }

        // --- Functions for Comparison Tab ---

        function renderScenarios() {
            const container = document.getElementById('scenarios-container');
            const tableContainer = document.getElementById('comparison-table-container');
            const tableBody = document.getElementById('comparison-table-body');
            
            container.innerHTML = '';
            tableBody.innerHTML = '';

            // Render Cards
            scenarios.forEach((s, index) => {
                const res = calculateEMI(s.amount, s.interest, s.tenure);
                
                const card = document.createElement('div');
                card.className = "bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow";
                card.innerHTML = `
                    <div class="bg-gray-50 p-3 border-b border-gray-100 flex justify-between items-center">
                        <h3 class="font-bold text-gray-700">Scenario ${index + 1}</h3>
                        ${scenarios.length > 1 ? `<button onclick="removeScenario(${s.id})" class="text-gray-400 hover:text-red-500 p-1"><i data-lucide="trash-2" class="w-4 h-4"></i></button>` : ''}
                    </div>
                    <div class="p-4 space-y-4">
                        <div>
                            <label class="text-xs text-gray-500 block mb-1">Loan Amount</label>
                            <input type="number" onchange="updateScenario(${s.id}, 'amount', this.value)" value="${s.amount}" class="w-full text-sm bg-gray-50 border border-gray-200 rounded px-2 py-1">
                        </div>
                        <div class="flex gap-2">
                            <div class="flex-1">
                                <label class="text-xs text-gray-500 block mb-1">Rate (%)</label>
                                <input type="number" step="0.1" onchange="updateScenario(${s.id}, 'interest', this.value)" value="${s.interest}" class="w-full text-sm bg-gray-50 border border-gray-200 rounded px-2 py-1 font-semibold text-indigo-600">
                            </div>
                            <div class="flex-1">
                                <label class="text-xs text-gray-500 block mb-1">Years</label>
                                <input type="number" onchange="updateScenario(${s.id}, 'tenure', this.value)" value="${s.tenure}" class="w-full text-sm bg-gray-50 border border-gray-200 rounded px-2 py-1">
                            </div>
                        </div>
                        <div class="pt-2 border-t border-dashed border-gray-200 space-y-2">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">EMI</span>
                                <span class="font-bold text-indigo-700">${formatCurrency(res.emi)}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">Interest</span>
                                <span class="font-bold text-red-600">${formatCurrency(res.totalInterest)}</span>
                            </div>
                            <div class="mt-2 bg-gray-100 rounded p-2 text-center">
                                <span class="text-xs text-gray-500 block">Total Cost</span>
                                <span class="font-bold text-gray-800 text-sm">${formatCurrency(res.totalPayment)}</span>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(card);

                // Add Table Row
                if (scenarios.length > 1) {
                    const row = document.createElement('tr');
                    row.className = "border-b border-gray-50 hover:bg-gray-50";
                    row.innerHTML = `
                        <td class="py-3 font-medium">Scenario ${index + 1}</td>
                        <td class="py-3">${s.interest}%</td>
                        <td class="py-3">${s.tenure} Years</td>
                        <td class="py-3 font-bold text-indigo-700">${formatCurrency(res.emi)}</td>
                        <td class="py-3 text-red-600">${formatCurrency(res.totalInterest)}</td>
                    `;
                    tableBody.appendChild(row);
                }
            });

            // Render Add Button
            const addBtn = document.createElement('button');
            addBtn.onclick = addScenario;
            addBtn.className = "border-2 border-dashed border-gray-300 rounded-xl flex flex-col items-center justify-center p-6 text-gray-400 hover:text-indigo-600 hover:border-indigo-300 hover:bg-indigo-50 transition-all min-h-[300px]";
            addBtn.innerHTML = `
                <i data-lucide="plus" class="w-8 h-8 mb-2"></i>
                <span class="font-medium">Add Scenario</span>
            `;
            container.appendChild(addBtn);

            // Toggle Table Visibility
            if (scenarios.length > 1) {
                tableContainer.classList.remove('hidden');
            } else {
                tableContainer.classList.add('hidden');
            }

            // Refresh Icons
            lucide.createIcons();
        }

        function addScenario() {
            const newId = scenarios.length > 0 ? Math.max(...scenarios.map(s => s.id)) + 1 : 1;
            scenarios.push({ 
                id: newId, 
                amount: calculatorState.principal, 
                interest: calculatorState.rate + 0.5, 
                tenure: calculatorState.years 
            });
            renderScenarios();
        }

        function removeScenario(id) {
            scenarios = scenarios.filter(s => s.id !== id);
            renderScenarios();
        }

        function updateScenario(id, field, value) {
            const index = scenarios.findIndex(s => s.id === id);
            if (index !== -1) {
                scenarios[index][field] = parseFloat(value) || 0;
                renderScenarios();
            }
        }

        // --- Tabs ---
        function switchTab(tab) {
            currentTab = tab;
            const calcView = document.getElementById('view-calculator');
            const compareView = document.getElementById('view-compare');
            const calcTabBtn = document.getElementById('tab-calculator');
            const compareTabBtn = document.getElementById('tab-compare');

            if (tab === 'calculator') {
                calcView.classList.remove('hidden');
                compareView.classList.add('hidden');
                
                calcTabBtn.className = "flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 bg-white text-indigo-700 shadow-md ring-1 ring-indigo-100";
                compareTabBtn.className = "flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 bg-gray-200 text-gray-500 hover:bg-gray-300";
            } else {
                calcView.classList.add('hidden');
                compareView.classList.remove('hidden');

                calcTabBtn.className = "flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 bg-gray-200 text-gray-500 hover:bg-gray-300";
                compareTabBtn.className = "flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 bg-white text-indigo-700 shadow-md ring-1 ring-indigo-100";
                
                renderScenarios();
            }
        }

        // Initialize
        setupCalculatorListeners();
        updateCalculatorUI();
        lucide.createIcons();
    </script>
</body>
</html>
