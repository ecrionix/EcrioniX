<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZS8C1FLY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XXZS8C1FLY');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kirchhoff's Laws: Theory & Lab - EcrioniX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Orbitron:wght@500;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <!-- MathJax for LaTeX Rendering -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #020617; color: #f8fafc; overflow: hidden; }
        .tech-font { font-family: 'Orbitron', sans-serif; }
        .mono-font { font-family: 'JetBrains Mono', monospace; }

        /* Watermark */
        .watermark {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) rotate(-30deg);
            font-size: 8rem; font-weight: 900;
            color: rgba(99, 102, 241, 0.03);
            pointer-events: none; user-select: none; z-index: 0;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
        }

        /* Tabs */
        .tab-btn {
            @apply px-6 py-3 font-bold text-sm transition-all duration-300 border-b-2 border-transparent text-slate-400;
        }
        .tab-active {
            @apply border-indigo-500 text-white bg-indigo-500/10;
        }

        /* Circuit Visuals */
        .wire { fill: none; stroke: #475569; stroke-width: 3; stroke-linecap: round; }
        .resistor-symbol { fill: none; stroke: #cbd5e1; stroke-width: 2; }
        .current-arrow {
            fill: #facc15;
            animation: flow 2s linear infinite;
        }
        @keyframes flow {
            from { stroke-dashoffset: 20; }
            to { stroke-dashoffset: 0; }
        }

        /* Theory Styles */
        .prose h1 { @apply text-3xl font-bold text-white mb-6 tech-font border-b border-slate-800 pb-2; }
        .prose h2 { @apply text-xl font-bold text-indigo-400 mt-8 mb-4 uppercase tracking-wider; }
        .prose p { @apply text-slate-400 mb-4 leading-relaxed; }
        .prose strong { @apply text-white font-semibold; }
        .prose ul { @apply list-disc list-inside space-y-2 text-slate-400 mb-4; }

        input[type=range] { accent-color: #6366f1; }
        
        .mode-pill { @apply px-3 py-1 rounded-full text-[10px] font-bold transition-all; }
        .mode-pill-active { @apply bg-indigo-600 text-white; }
        .mode-pill-inactive { @apply bg-slate-800 text-slate-500; }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
    </style>
</head>
<body class="h-screen w-screen flex flex-col relative">

    <div class="watermark">EcrioniX Physics</div>

    <!-- Header -->
    <nav class="border-b border-slate-800 bg-slate-900/80 px-6 py-3 flex justify-between items-center z-50">
        <div class="flex items-center gap-8">
            <div>
                <h1 class="text-xl font-bold text-indigo-400 tech-font uppercase">Kirchhoff's <span class="text-white">Lab</span></h1>
            </div>
            <!-- Main Navigation Tabs -->
            <div class="flex">
                <button onclick="switchView('theory')" id="btn-view-theory" class="tab-btn tab-active">THEORY OVERVIEW</button>
                <button onclick="switchView('lab')" id="btn-view-lab" class="tab-btn">INTERACTIVE LAB</button>
            </div>
        </div>
        
        <button onclick="window.history.back()" class="group flex items-center text-slate-400 hover:text-white transition bg-slate-800/80 px-4 py-2 rounded-lg border border-slate-700 hover:border-indigo-500">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
            <span class="text-xs font-bold uppercase">Exit Lab</span>
        </button>
    </nav>

    <!-- Content Sections -->
    <div class="flex-grow overflow-hidden relative">
        
        <!-- SECTION 1: THEORY -->
        <div id="section-theory" class="absolute inset-0 z-10 overflow-y-auto p-8 flex justify-center">
            <div class="max-w-4xl w-full glass-panel p-10 prose">
                <h1>Introduction to Kirchhoff's Laws</h1>
                <p>
                    Gustav Kirchhoff, a German physicist, formulated two fundamental laws in 1845 that allow engineers to analyze complex electrical circuits. These laws are the bedrock of network analysis and are derived from basic conservation principles in physics.
                </p>

                <h2>1. Kirchhoff's Current Law (KCL)</h2>
                <p><strong>Also known as: The Junction Rule or First Law</strong></p>
                <div class="bg-indigo-500/5 border-l-4 border-indigo-500 p-4 my-6">
                    <p class="text-white font-medium italic mb-2">The Statement:</p>
                    <p class="text-slate-300">The algebraic sum of currents entering any junction (node) in an electrical circuit is exactly equal to the sum of currents leaving that junction.</p>
                </div>
                <p><strong>Mathematical Form:</strong></p>
                <p class="text-center py-4 text-xl">
                    \[ \sum I_{in} = \sum I_{out} \quad \text{or} \quad \sum I_{k} = 0 \]
                </p>
                <p><strong>Physical Principle:</strong></p>
                <p>
                    KCL is based on the <strong>Conservation of Charge</strong>. Since charge cannot be created or destroyed at a point, any electrons flowing into a wire junction must flow out through the available branches.
                </p>

                <h2>2. Kirchhoff's Voltage Law (KVL)</h2>
                <p><strong>Also known as: The Loop Rule or Second Law</strong></p>
                <div class="bg-indigo-500/5 border-l-4 border-indigo-500 p-4 my-6">
                    <p class="text-white font-medium italic mb-2">The Statement:</p>
                    <p class="text-slate-300">The directed sum of the potential differences (voltages) around any closed loop in a circuit is zero.</p>
                </div>
                <p><strong>Mathematical Form:</strong></p>
                <p class="text-center py-4 text-xl">
                    \[ \sum V_{sources} = \sum V_{drops} \quad \text{or} \quad \sum V_{k} = 0 \]
                </p>
                <p><strong>Physical Principle:</strong></p>
                <p>
                    KVL is based on the <strong>Conservation of Energy</strong>. As a charge moves around a closed loop and returns to its starting point, it neither gains nor loses net energy. The energy supplied by the source is exactly equal to the energy consumed by the components in that loop.
                </p>

                <div class="mt-12 text-center">
                    <button onclick="switchView('lab')" class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-4 rounded-xl font-bold transition shadow-lg shadow-indigo-500/30">
                        START EXPERIMENT &rarr;
                    </button>
                </div>
            </div>
        </div>

        <!-- SECTION 2: LAB -->
        <div id="section-lab" class="absolute inset-0 z-0 opacity-0 pointer-events-none flex p-6 gap-6 overflow-hidden">
            
            <!-- Left: Meters -->
            <div class="w-80 flex flex-col gap-4">
                <div class="glass-panel p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 id="meter-title" class="text-indigo-400 font-bold uppercase text-[10px] tracking-widest">KCL Junction Check</h2>
                        <div class="flex gap-1 bg-slate-900 p-1 rounded-lg">
                            <button onclick="setLabMode('KCL')" id="pill-kcl" class="mode-pill mode-pill-active">KCL</button>
                            <button onclick="setLabMode('KVL')" id="pill-kvl" class="mode-pill mode-pill-inactive">KVL</button>
                        </div>
                    </div>
                    
                    <div class="space-y-3">
                        <div id="meter-line-1" class="bg-black/40 p-3 rounded-lg border border-slate-800">
                            <div class="text-[10px] text-slate-500 uppercase mb-1">Incoming Value</div>
                            <div id="val-primary" class="text-xl font-bold text-white mono-font">1.000 <span class="text-xs text-slate-500">A</span></div>
                        </div>
                        <div class="flex justify-center text-indigo-500 font-bold">=</div>
                        <div id="meter-line-2" class="bg-black/40 p-3 rounded-lg border border-slate-800">
                            <div class="text-[10px] text-slate-500 uppercase mb-1">Outgoing/Drop Sum</div>
                            <div id="val-secondary" class="text-xl font-bold text-emerald-400 mono-font">1.000 <span class="text-xs text-slate-500">A</span></div>
                        </div>
                    </div>
                    <div id="law-stat" class="mt-4 text-center text-[10px] font-bold text-emerald-500 bg-emerald-500/10 py-1 rounded border border-emerald-500/20">
                        LAW VERIFIED
                    </div>
                </div>

                <div class="glass-panel p-4 flex-grow flex flex-col overflow-hidden">
                    <h2 class="text-slate-500 font-bold mb-2 uppercase text-[10px] tracking-widest">Lab Journal</h2>
                    <div class="flex-grow overflow-y-auto bg-black/20 rounded border border-slate-800">
                        <table class="w-full text-[10px] text-left">
                            <thead class="bg-slate-800 text-slate-400 sticky top-0">
                                <tr id="table-head">
                                    <th class="p-2">V (Src)</th>
                                    <th class="p-2">Left Side</th>
                                    <th class="p-2">Right Side</th>
                                    <th class="p-2">Error</th>
                                </tr>
                            </thead>
                            <tbody id="data-table" class="text-slate-300 divide-y divide-slate-800"></tbody>
                        </table>
                    </div>
                    <button onclick="logData()" class="mt-4 w-full py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-lg shadow-lg transition transform active:scale-95 text-xs">
                        RECORD DATA
                    </button>
                </div>
            </div>

            <!-- Center: Circuit -->
            <div class="flex-grow glass-panel relative flex items-center justify-center overflow-hidden">
                <svg id="circuit-svg" width="600" height="400" viewBox="0 0 600 400" class="drop-shadow-2xl">
                    <path d="M100,200 V100 H500 V300 H100 V200" class="wire" />
                    <path d="M300,100 V300" class="wire" />

                    <g transform="translate(100, 200)">
                        <rect x="-10" y="-20" width="20" height="40" fill="#020617" />
                        <line x1="-10" y1="-5" x2="10" y2="-5" stroke="white" stroke-width="1" />
                        <line x1="-5" y1="0" x2="5" y2="0" stroke="white" stroke-width="3" />
                        <line x1="-10" y1="5" x2="10" y2="5" stroke="white" stroke-width="1" />
                        <line x1="-5" y1="10" x2="5" y2="10" stroke="white" stroke-width="3" />
                    </g>

                    <g transform="translate(200, 100)">
                        <rect x="-20" y="-10" width="40" height="20" fill="#020617" />
                        <path d="M-20,0 L-15,-10 L-5,10 L5,-10 L15,10 L20,0" class="resistor-symbol" />
                        <text x="0" y="-15" text-anchor="middle" class="tech-font" fill="#6366f1" font-size="10">R1</text>
                    </g>
                    <g transform="translate(300, 200) rotate(90)">
                        <rect x="-20" y="-10" width="40" height="20" fill="#020617" />
                        <path d="M-20,0 L-15,-10 L-5,10 L5,-10 L15,10 L20,0" class="resistor-symbol" />
                        <text x="0" y="25" text-anchor="middle" class="tech-font" fill="#10b981" font-size="10" transform="rotate(-90)">R2</text>
                    </g>
                    <g transform="translate(400, 100)">
                        <rect x="-20" y="-10" width="40" height="20" fill="#020617" />
                        <path d="M-20,0 L-15,-10 L-5,10 L5,-10 L15,10 L20,0" class="resistor-symbol" />
                        <text x="0" y="-15" text-anchor="middle" class="tech-font" fill="#f59e0b" font-size="10">R3</text>
                    </g>

                    <circle cx="300" cy="100" r="5" fill="#facc15" />
                    <text x="300" y="85" text-anchor="middle" fill="#facc15" font-weight="bold" font-size="12" id="junction-label">Node A</text>

                    <path id="flow-i1" d="M100,100 H300" stroke="#facc15" stroke-width="2" stroke-dasharray="5,5" fill="none" class="current-arrow" />
                    <path id="flow-i2" d="M300,100 V300" stroke="#facc15" stroke-width="2" stroke-dasharray="5,5" fill="none" class="current-arrow" />
                    <path id="flow-i3" d="M300,100 H500 V300" stroke="#facc15" stroke-width="2" stroke-dasharray="5,5" fill="none" class="current-arrow" />
                </svg>
                
                <div id="kvl-loop" class="absolute inset-0 flex items-center justify-center pointer-events-none opacity-0 transition-opacity">
                    <div class="w-48 h-32 border-2 border-dashed border-indigo-500/50 rounded-lg flex items-center justify-center">
                        <span class="text-[10px] text-indigo-400 font-bold bg-slate-900 px-2 uppercase">Loop 1 Analysis</span>
                    </div>
                </div>
            </div>

            <!-- Right: Config -->
            <div class="w-80 flex flex-col gap-6">
                <div class="glass-panel p-6">
                    <h2 class="text-indigo-400 font-bold mb-6 uppercase text-[10px] tracking-widest">Tuning</h2>
                    <div class="space-y-6">
                        <div>
                            <div class="flex justify-between text-xs mb-2"><span class="text-slate-400">Voltage Source (V)</span><span id="lbl-vs" class="text-white font-bold">12V</span></div>
                            <input type="range" id="slider-vs" min="1" max="30" value="12" class="w-full">
                        </div>
                        <div>
                            <div class="flex justify-between text-xs mb-2"><span class="text-indigo-400">Resistor R1 (Ω)</span><span id="lbl-r1" class="text-white font-bold">100</span></div>
                            <input type="range" id="slider-r1" min="10" max="500" step="10" value="100" class="w-full">
                        </div>
                        <div>
                            <div class="flex justify-between text-xs mb-2"><span class="text-emerald-400">Resistor R2 (Ω)</span><span id="lbl-r2" class="text-white font-bold">200</span></div>
                            <input type="range" id="slider-r2" min="10" max="500" step="10" value="200" class="w-full">
                        </div>
                        <div>
                            <div class="flex justify-between text-xs mb-2"><span class="text-amber-400">Resistor R3 (Ω)</span><span id="lbl-r3" class="text-white font-bold">200</span></div>
                            <input type="range" id="slider-r3" min="10" max="500" step="10" value="200" class="w-full">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- State ---
        let view = 'theory';
        let labMode = 'KCL';
        let vs=12, r1=100, r2=200, r3=200;

        // --- View Switching ---
        function switchView(target) {
            view = target;
            const theory = document.getElementById('section-theory');
            const lab = document.getElementById('section-lab');
            const btnT = document.getElementById('btn-view-theory');
            const btnL = document.getElementById('btn-view-lab');

            if(target === 'theory') {
                theory.classList.remove('opacity-0', 'pointer-events-none');
                theory.classList.add('z-10');
                lab.classList.add('opacity-0', 'pointer-events-none');
                lab.classList.remove('z-10');
                btnT.classList.add('tab-active');
                btnL.classList.remove('tab-active');
            } else {
                lab.classList.remove('opacity-0', 'pointer-events-none');
                lab.classList.add('z-10');
                theory.classList.add('opacity-0', 'pointer-events-none');
                theory.classList.remove('z-10');
                btnL.classList.add('tab-active');
                btnT.classList.remove('tab-active');
                updateSimulation(); // Refresh math
            }
        }

        // --- Lab Logic ---
        function setLabMode(mode) {
            labMode = mode;
            document.getElementById('pill-kcl').className = mode === 'KCL' ? 'mode-pill mode-pill-active' : 'mode-pill mode-pill-inactive';
            document.getElementById('pill-kvl').className = mode === 'KVL' ? 'mode-pill mode-pill-active' : 'mode-pill mode-pill-inactive';
            
            document.getElementById('meter-title').innerText = mode === 'KCL' ? "KCL Junction Check" : "KVL Loop Check";
            document.getElementById('junction-label').innerText = mode === 'KCL' ? "Node A" : "Loop Entry";
            document.getElementById('kvl-loop').style.opacity = mode === 'KVL' ? '1' : '0';
            
            updateSimulation();
        }

        function updateSimulation() {
            vs = parseFloat(document.getElementById('slider-vs').value);
            r1 = parseFloat(document.getElementById('slider-r1').value);
            r2 = parseFloat(document.getElementById('slider-r2').value);
            r3 = parseFloat(document.getElementById('slider-r3').value);

            document.getElementById('lbl-vs').innerText = vs + "V";
            document.getElementById('lbl-r1').innerText = r1;
            document.getElementById('lbl-r2').innerText = r2;
            document.getElementById('lbl-r3').innerText = r3;

            // Math
            const rp = (r2 * r3) / (r2 + r3);
            const req = r1 + rp;
            const i1 = vs / req;
            const vp = i1 * rp;
            const i2 = vp / r2;
            const i3 = vp / r3;
            const v1 = i1 * r1;
            const v2 = i2 * r2;

            if(labMode === 'KCL') {
                document.getElementById('val-primary').innerHTML = `${i1.toFixed(3)} <span class="text-xs text-slate-500">A</span>`;
                document.getElementById('val-secondary').innerHTML = `${(i2+i3).toFixed(3)} <span class="text-xs text-slate-500">A</span>`;
            } else {
                document.getElementById('val-primary').innerHTML = `${vs.toFixed(2)} <span class="text-xs text-slate-500">V</span>`;
                document.getElementById('val-secondary').innerHTML = `${(v1+v2).toFixed(2)} <span class="text-xs text-slate-500">V</span>`;
            }

            // Animation
            const speed = i1 * 5;
            document.getElementById('flow-i1').style.animationDuration = `${2/speed}s`;
            document.getElementById('flow-i2').style.animationDuration = `${2/(i2*5)}s`;
            document.getElementById('flow-i3').style.animationDuration = `${2/(i3*5)}s`;
        }

        function logData() {
            const rp = (r2 * r3) / (r2 + r3);
            const i1 = vs / (r1 + rp);
            const vp = i1 * rp;
            const i2 = vp / r2;
            const i3 = vp / r3;
            const v1 = i1 * r1;
            const v2 = i2 * r2;

            const row = document.createElement('tr');
            if(labMode === 'KCL') {
                const diff = Math.abs(i1 - (i2+i3)).toFixed(6);
                row.innerHTML = `<td class="p-2">${vs}V</td><td class="p-2">${i1.toFixed(3)}A</td><td class="p-2">${(i2+i3).toFixed(3)}A</td><td class="p-2 text-emerald-400">${diff}</td>`;
            } else {
                const diff = Math.abs(vs - (v1+v2)).toFixed(6);
                row.innerHTML = `<td class="p-2">${vs}V</td><td class="p-2">${v1.toFixed(2)}V</td><td class="p-2">${(v1+v2).toFixed(2)}V</td><td class="p-2 text-emerald-400">${diff}</td>`;
            }
            document.getElementById('data-table').prepend(row);
        }

        // Init
        document.querySelectorAll('input[type=range]').forEach(s => s.addEventListener('input', updateSimulation));
        updateSimulation();

    </script>
</body>
</html>
