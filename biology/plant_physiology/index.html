<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZS8C1FLY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XXZS8C1FLY');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photosynthesis Rate Lab - EcrioniX</title>
    <meta name="description" content="Virtual Biology Lab: Measuring the rate of photosynthesis in aquatic plants.">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #020617; color: #f8fafc; }
        .brand-font { font-family: 'Orbitron', sans-serif; }
        
        /* Watermark */
        .watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-30deg);
            font-size: 8rem;
            font-weight: 900;
            color: rgba(244, 63, 94, 0.03); /* Rose tint */
            pointer-events: none;
            user-select: none;
            white-space: nowrap;
            z-index: 0;
        }

        /* Glassmorphism */
        .glass-panel {
            background: rgba(30, 41, 59, 0.4);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
        }

        /* Animation for Bubbles */
        @keyframes rise {
            0% { bottom: 20px; opacity: 0; transform: scale(0.5); }
            10% { opacity: 1; }
            100% { bottom: 180px; opacity: 0; transform: scale(1.2); }
        }
        
        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            width: 8px;
            height: 8px;
            left: 50%;
            pointer-events: none;
            box-shadow: 0 0 4px rgba(255,255,255,0.8);
        }

        /* Lamp Glow Effect */
        #lamp-light {
            transition: all 0.3s ease;
            background: radial-gradient(circle, rgba(255,255,200,0.8) 0%, rgba(255,255,200,0) 70%);
            pointer-events: none;
        }

        /* Custom Range Slider */
        input[type=range] { accent-color: #f43f5e; }
    </style>
</head>
<body class="relative min-h-screen flex flex-col">

    <div class="watermark">EcrioniX</div>
    
    <!-- Navbar -->
    <nav class="sticky top-0 z-50 border-b border-slate-800 bg-slate-950/80 backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <span class="brand-font text-2xl font-bold text-white tracking-wider">Ecrioni<span class="text-rose-500">X</span></span>
                    <span class="ml-4 px-2 py-1 bg-rose-500/10 text-rose-400 text-xs rounded border border-rose-500/20">BIO LAB</span>
                </div>
                <a href="../index.html" class="text-sm text-slate-400 hover:text-white transition flex items-center">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                    Back to Biology
                </a>
            </div>
        </div>
    </nav>

    <!-- Lab Content -->
    <main class="flex-grow pt-8 pb-20 relative z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            
            <!-- Header -->
            <div class="mb-8 border-b border-slate-800 pb-4">
                <h1 class="text-3xl font-bold text-white brand-font">Plant Physiology: Photosynthesis Rate</h1>
                <p class="text-slate-400 mt-1">Investigating the effect of light intensity on the rate of oxygen production in aquatic plants.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                
                <!-- LEFT COLUMN: Simulator -->
                <div class="lg:col-span-5 space-y-6">
                    
                    <!-- Experiment Visualizer -->
                    <div class="glass-panel rounded-xl p-1 relative overflow-hidden bg-slate-900/50">
                        <div class="h-80 relative flex items-end justify-center overflow-hidden" id="sim-container">
                            
                            <!-- Lamp (Movable) -->
                            <div id="lamp-container" class="absolute top-10 right-0 h-full w-24 flex flex-col items-center transition-all duration-300" style="right: 10px;">
                                <div class="w-20 h-20 bg-yellow-100 rounded-full blur-sm shadow-[0_0_50px_#fef08a]" id="lamp-bulb"></div>
                                <div class="w-2 h-full bg-slate-700"></div>
                                <div class="w-16 h-4 bg-slate-600 rounded-t"></div>
                            </div>

                            <!-- Light Cone -->
                            <div id="lamp-light" class="absolute top-20 right-12 w-[600px] h-[600px] opacity-50 transform -translate-y-1/2 rounded-full mix-blend-screen"></div>

                            <!-- Beaker & Plant -->
                            <div class="relative z-10 mb-4">
                                <!-- Beaker -->
                                <div class="w-32 h-48 border-x-2 border-b-4 border-slate-400/50 rounded-b-xl bg-blue-400/10 backdrop-blur-sm relative overflow-hidden">
                                    <!-- Water Level -->
                                    <div class="absolute bottom-0 w-full h-[90%] bg-blue-500/20"></div>
                                    
                                    <!-- Funnel (inverted) -->
                                    <div class="absolute bottom-4 left-1/2 -translate-x-1/2 w-0 h-0 border-l-[40px] border-l-transparent border-r-[40px] border-r-transparent border-b-[60px] border-b-slate-300/30 opacity-50"></div>
                                    
                                    <!-- Test Tube (inverted) -->
                                    <div class="absolute bottom-[64px] left-1/2 -translate-x-1/2 w-4 h-24 border-2 border-slate-300/50 rounded-t-full bg-blue-500/10">
                                        <!-- Rising Bubbles Container -->
                                        <div id="bubbles-area" class="w-full h-full relative overflow-hidden"></div>
                                    </div>

                                    <!-- Elodea Plant (SVG) -->
                                    <svg class="absolute bottom-4 left-1/2 -translate-x-1/2 w-20 h-32 text-green-600" viewBox="0 0 100 150" fill="currentColor">
                                        <path d="M50 150 Q40 100 60 80 Q80 60 50 40 Q20 20 50 0" fill="none" stroke="currentColor" stroke-width="3" />
                                        <circle cx="50" cy="140" r="2" />
                                        <!-- Leaves -->
                                        <path d="M50 120 Q30 110 20 125 Q40 130 50 120" />
                                        <path d="M50 100 Q70 90 80 105 Q60 110 50 100" />
                                        <path d="M55 80 Q75 70 85 85 Q65 90 55 80" />
                                        <path d="M45 60 Q25 50 15 65 Q35 70 45 60" />
                                    </svg>
                                </div>
                            </div>

                            <!-- Ruler (Visual) -->
                            <div class="absolute bottom-0 w-full h-8 border-t border-slate-600 flex justify-between px-4 text-[10px] text-slate-500 font-mono">
                                <span>50cm</span><span>40cm</span><span>30cm</span><span>20cm</span><span>10cm</span><span>0cm</span>
                            </div>
                        </div>
                    </div>

                    <!-- Controls -->
                    <div class="glass-panel rounded-xl p-6">
                        <h3 class="text-sm font-bold text-white mb-4 uppercase tracking-wider flex justify-between">
                            <span>Lab Controls</span>
                            <span id="bubble-rate-display" class="text-rose-400 font-mono">Rate: 0 bpm</span>
                        </h3>
                        
                        <div class="space-y-6">
                            <!-- Distance Slider -->
                            <div>
                                <div class="flex justify-between text-sm mb-2">
                                    <span class="text-slate-400">Lamp Distance</span>
                                    <span id="lbl-dist" class="text-rose-400 font-mono font-bold">50 cm</span>
                                </div>
                                <!-- Range reversed visually: 50cm is far (left), 0 is close (right) for UI feel -->
                                <input type="range" id="slider-dist" min="5" max="50" step="5" value="50" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer" style="direction: rtl">
                            </div>

                            <!-- CO2 Slider -->
                            <div>
                                <div class="flex justify-between text-sm mb-2">
                                    <span class="text-slate-400">Sodium Bicarbonate (CO₂)</span>
                                    <span id="lbl-co2" class="text-rose-400 font-mono font-bold">0.5 %</span>
                                </div>
                                <input type="range" id="slider-co2" min="0.1" max="2.0" step="0.1" value="0.5" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer">
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div class="bg-slate-900 p-3 rounded text-center border border-slate-700">
                                    <div class="text-[10px] text-slate-500 mb-1">BUBBLE COUNTER</div>
                                    <div id="counter-val" class="text-2xl font-mono font-bold text-white">0</div>
                                    <button onclick="resetCounter()" class="text-[10px] text-rose-400 hover:text-rose-300 underline mt-1">Reset</button>
                                </div>
                                <div class="bg-slate-900 p-3 rounded text-center border border-slate-700">
                                    <div class="text-[10px] text-slate-500 mb-1">STOPWATCH</div>
                                    <div id="timer-val" class="text-2xl font-mono font-bold text-white">00:00</div>
                                    <div class="flex justify-center space-x-2 mt-1">
                                        <button onclick="toggleTimer()" id="btn-timer" class="text-[10px] text-green-400 hover:text-green-300 font-bold">START</button>
                                        <button onclick="resetTimer()" class="text-[10px] text-slate-400 hover:text-slate-300">RESET</button>
                                    </div>
                                </div>
                            </div>

                            <button onclick="recordData()" class="w-full bg-rose-600 hover:bg-rose-500 text-white font-bold py-3 rounded-lg transition shadow-lg shadow-rose-500/20 active:scale-95">
                                Record Current Rate
                            </button>
                        </div>
                    </div>

                </div>

                <!-- RIGHT COLUMN: Analysis -->
                <div class="lg:col-span-7 space-y-6">
                    
                    <!-- Graph -->
                    <div class="glass-panel rounded-xl p-4 h-80">
                        <canvas id="photoChart"></canvas>
                    </div>

                    <!-- Observation Table -->
                    <div class="glass-panel rounded-xl overflow-hidden">
                        <table class="w-full text-sm text-left">
                            <thead class="text-xs text-slate-400 uppercase bg-slate-900/50 border-b border-slate-700">
                                <tr>
                                    <th class="px-6 py-3">Distance (cm)</th>
                                    <th class="px-6 py-3">Light Intensity (1/d²)</th>
                                    <th class="px-6 py-3">Rate (Bubbles/min)</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="text-slate-300 divide-y divide-slate-800">
                                <tr class="bg-slate-900/20">
                                    <td colspan="3" class="px-6 py-4 text-center text-slate-500 italic">No readings recorded yet.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Theory Summary -->
                    <div class="glass-panel rounded-xl p-6">
                        <h3 class="text-lg font-bold text-white mb-3 flex items-center">
                            <svg class="w-5 h-5 mr-2 text-rose-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                            Key Concepts
                        </h3>
                        <ul class="list-disc list-inside text-slate-400 text-sm space-y-2">
                            <li><strong>Chemical Equation:</strong> <span class="font-mono text-rose-300">6CO₂ + 6H₂O + Light → C₆H₁₂O₆ + 6O₂</span></li>
                            <li><strong>Inverse Square Law:</strong> Light intensity is inversely proportional to the square of the distance (<span class="font-mono">I ∝ 1/d²</span>).</li>
                            <li><strong>Limiting Factors:</strong> Photosynthesis increases with light intensity up to a point, after which other factors (like CO₂ or temperature) become limiting.</li>
                        </ul>
                    </div>

                </div>
            </div>

        </div>
    </main>

    <!-- Footer -->
    <footer class="mt-auto border-t border-slate-800 bg-slate-950 py-8 text-center">
        <p class="text-slate-600 text-sm">
            &copy; 2026 EcrioniX Labs. Owned by <span class="text-rose-400">Elangovan</span>.
        </p>
    </footer>

    <!-- Lab Logic -->
    <script>
        // --- State ---
        let distance = 50; // cm
        let co2 = 0.5; // %
        let bubbleCount = 0;
        let bubbleInterval;
        let currentRate = 0; // bubbles per minute (calculated)
        
        let timerTime = 0;
        let timerInterval = null;
        let isTimerRunning = false;

        let readings = [];
        let chart;

        // --- DOM ---
        const sliderDist = document.getElementById('slider-dist');
        const sliderCo2 = document.getElementById('slider-co2');
        const lblDist = document.getElementById('lbl-dist');
        const lblCo2 = document.getElementById('lbl-co2');
        const lampContainer = document.getElementById('lamp-container');
        const lampLight = document.getElementById('lamp-light');
        const bubblesArea = document.getElementById('bubbles-area');
        const counterVal = document.getElementById('counter-val');
        const rateDisplay = document.getElementById('bubble-rate-display');
        const timerVal = document.getElementById('timer-val');
        const btnTimer = document.getElementById('btn-timer');
        const tableBody = document.getElementById('table-body');

        // --- Logic ---

        function calculateRate() {
            // Photosynthesis Model
            // Rate ~ (Light Intensity) * (CO2 Factor)
            // Light Intensity = 10000 / (d^2)  (Arbitrary scaling)
            const intensity = 200000 / (distance * distance);
            
            // CO2 saturation curve (Michaelis-Menten-ish)
            const co2Factor = (co2 / (co2 + 0.2)); 

            // Base rate
            let rawRate = intensity * co2Factor;
            
            // Cap max rate (Biology limiting factors)
            if (rawRate > 150) rawRate = 150 + (rawRate - 150) * 0.1;
            
            // Convert to bubbles per minute
            currentRate = Math.floor(rawRate);
            
            // Update UI
            rateDisplay.innerText = `Rate: ~${currentRate} bpm`;
            
            updateAnimationRate(currentRate);
        }

        function updateAnimationRate(bpm) {
            clearInterval(bubbleInterval);
            
            if (bpm <= 0) return;

            const intervalMs = (60000 / bpm);
            
            bubbleInterval = setInterval(() => {
                createBubble();
                if(isTimerRunning) {
                    bubbleCount++;
                    counterVal.innerText = bubbleCount;
                }
            }, intervalMs);
        }

        function createBubble() {
            const b = document.createElement('div');
            b.className = 'bubble';
            // Random x offset
            b.style.left = (50 + (Math.random() * 20 - 10)) + '%';
            b.style.animation = `rise ${2 + Math.random()}s linear forwards`;
            bubblesArea.appendChild(b);

            // Cleanup
            setTimeout(() => { b.remove(); }, 3000);
        }

        function updateVisuals() {
            // Move Lamp visually
            // Slider 5cm (Right/Close) -> 50cm (Left/Far)
            // Visual container width ~ 300px?
            // Map 5..50 to position
            // distance 5 -> Rightmost (close to beaker)
            // distance 50 -> Leftmost
            
            const maxPx = 250; 
            const pos = ((50 - distance) / 45) * maxPx; // 0 at 50cm, maxPx at 5cm
            
            lampContainer.style.transform = `translateX(-${pos}px)`;
            
            // Light Intensity visual
            const opacity = 1 - (distance / 60);
            lampLight.style.opacity = Math.max(0.1, opacity);
            lampLight.style.transform = `translate(-${pos}px, -50%)`;
        }

        // --- Event Listeners ---
        sliderDist.addEventListener('input', (e) => {
            distance = parseInt(e.target.value);
            lblDist.innerText = distance + " cm";
            calculateRate();
            updateVisuals();
        });

        sliderCo2.addEventListener('input', (e) => {
            co2 = parseFloat(e.target.value);
            lblCo2.innerText = co2 + " %";
            calculateRate();
        });

        // --- Timer Logic ---
        function toggleTimer() {
            if(isTimerRunning) {
                // Stop
                isTimerRunning = false;
                clearInterval(timerInterval);
                btnTimer.innerText = "START";
                btnTimer.className = "text-[10px] text-green-400 hover:text-green-300 font-bold";
            } else {
                // Start
                isTimerRunning = true;
                bubbleCount = 0; // Reset counter on start for easy measuring
                counterVal.innerText = 0;
                
                btnTimer.innerText = "STOP";
                btnTimer.className = "text-[10px] text-red-400 hover:text-red-300 font-bold";
                
                timerInterval = setInterval(() => {
                    timerTime++;
                    const m = Math.floor(timerTime / 60).toString().padStart(2, '0');
                    const s = (timerTime % 60).toString().padStart(2, '0');
                    timerVal.innerText = `${m}:${s}`;
                }, 1000);
            }
        }

        function resetTimer() {
            isTimerRunning = false;
            clearInterval(timerInterval);
            timerTime = 0;
            bubbleCount = 0;
            timerVal.innerText = "00:00";
            counterVal.innerText = "0";
            btnTimer.innerText = "START";
            btnTimer.className = "text-[10px] text-green-400 hover:text-green-300 font-bold";
        }

        function resetCounter() {
            bubbleCount = 0;
            counterVal.innerText = "0";
        }

        // --- Graphing & Data ---
        const ctx = document.getElementById('photoChart').getContext('2d');
        chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Rate vs Light Intensity',
                    data: [],
                    borderColor: '#f43f5e', // Rose
                    backgroundColor: 'rgba(244, 63, 94, 0.2)',
                    borderWidth: 2,
                    pointRadius: 4,
                    fill: true,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        title: { display: true, text: 'Light Intensity (Arbitrary Units)', color: '#94a3b8' },
                        grid: { color: '#334155' },
                        ticks: { color: '#cbd5e1' }
                    },
                    y: {
                        title: { display: true, text: 'Rate (Bubbles/min)', color: '#94a3b8' },
                        grid: { color: '#334155' },
                        ticks: { color: '#cbd5e1' },
                        beginAtZero: true
                    }
                },
                plugins: {
                    legend: { labels: { color: '#cbd5e1' } }
                }
            }
        });

        function recordData() {
            // Calculate Intensity metric for X axis (1/d^2 * 1000 for readable numbers)
            const intensityMetric = (10000 / (distance * distance)).toFixed(2);
            
            // Avoid duplicates close together
            if (readings.some(r => Math.abs(r.x - intensityMetric) < 0.1)) return;

            const point = { x: parseFloat(intensityMetric), y: currentRate, dist: distance };
            readings.push(point);
            
            // Sort by intensity for proper line graph
            readings.sort((a, b) => a.x - b.x);

            // Update Table
            updateTable();
            
            // Update Graph
            chart.data.labels = readings.map(r => r.x);
            chart.data.datasets[0].data = readings.map(r => r.y);
            chart.update();
        }

        function updateTable() {
            tableBody.innerHTML = '';
            readings.forEach(r => {
                const row = `
                    <tr class="hover:bg-slate-800/50 transition">
                        <td class="px-6 py-3 font-mono text-white">${r.dist}</td>
                        <td class="px-6 py-3 font-mono text-white">${r.x}</td>
                        <td class="px-6 py-3 font-mono text-rose-400 font-bold">${r.y}</td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }

        // Init
        calculateRate();
        updateVisuals();

    </script>

</body>
</html>
